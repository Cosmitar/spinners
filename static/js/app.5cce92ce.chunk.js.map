{"version":3,"sources":["assets/arena/throttle_button.png","src/systems/World/Events.js","assets/emotes/emote_swirl.png","assets/arena/icon.png","assets/arena/icon_mask.png","assets/icons/locked.png","assets/icons/trophy.png","assets/icons/arrowDown.png","assets/sounds/music/arena_completed.mp3","assets/sounds/music/arena_won.mp3","assets/sounds/fx/ufoHit.mp3","assets/sounds/fx/teleport.mp3","assets/sounds/fx/coil_discharge.mp3","assets/sounds/fx/crystal_pick.mp3","assets/sounds/fx/grow.mp3","assets/sounds/fx/freezeEffect.mp3","assets/sounds/music/gameplay.mp3","src/state/storage.js","src/state/reducers.js","src/state/index.js","src/state/actions.js","src/state/provider.js","src/systems/World/hooks.js","src/helpers/anime.js","src/components/CountDown/index.js","src/hooks/useKeyPress.js","src/systems/HUD/Controllers.js","src/components/Arena/index.js","src/systems/Physics/context.js","src/systems/Physics/hooks.js","src/components/UfoModels/UfoModel1.js","src/components/UfoModels/UfoModel2.js","src/components/UfoModels/UfoModel3.js","src/components/UfoModels/UfoModel4.js","src/constants/gameOptions.js","src/components/UfoShip/index.js","src/hooks/useOutOfTheBox.js","src/helpers/arenaHelper.js","src/helpers/animateFallUp.js","src/components/Player/index.js","src/helpers/respawnMe.js","src/hooks/useCollision.tsx","src/components/Enemy/index.js","src/systems/World/CharactersLoop.js","src/systems/World/HitPhysics.js","src/systems/Physics/Provider.js","src/systems/Physics/index.js","src/constants/levels.js","src/components/Crystal/index.js","src/screens/GamePlay/index.js","src/components/Wall/index.js","src/components/RevertSpinArea/index.js","src/components/UfoBase/index.js","src/components/Portals/index.js","src/systems/HUD/index.js","src/constants/webView_comm_messages.js","src/helpers/computeFilters.js","src/screens/LevelSelection/index.js","src/screens/ScreenManager/index.js","webpack:////Users/cosmitar/Development/mobile/spinners/index.js?7866","App.js","src/systems/World/EventsManager.ts","assets/threeTone.jpg","src/systems/World/index.js","src/helpers/eventsService.js"],"names":["module","exports","CHARACTER_EVENTS","OUT_OF_RING","BEGIN_CONTACT","END_CONTACT","OVERCHARGE","DISCHARGE","GETS_FREEZER","UNFREEZE","GETS_COIL","PICK_CRYSTAL_FREEZER","PICK_CRYSTAL_HULK","PICK_CRYSTAL_COIL","EXTERNAL_SPIN_CHANGE","TELEPORT","IMPULSE_ON","IMPULSE_OFF","GAME_EVENTS","READY_ON","READY_OFF","SYSTEM_ONLINE","getStateFromStorage","a","async","AsyncStorage","getItem","storedValue","JSON","parse","initialState","screen","overlay","currentLevel","latestArenaResult","Number","MAX_SAFE_INTEGER","showEnding","arenas","type","locked","name","result","app","state","action","switchObj","NAVIGATE","payload","SET_CURRENT_LEVEL","SET_SHOW_ENDING","SET_ARENA_RESULT","arenaIndex","SET_OVERLAY","UPDATE_STORED_PROGRESS","UPDATE_STATE_FROM_STORAGE","DEFAULT","newState","hasOwnProperty","setItem","stringify","setStateToStorage","useStateManager","useEffect","actions","updateStateFromStorage","loadStore","dispatch","useReducer","stateReducer","stateDispatch","navigate","setCurrentLevel","setArenaResult","showOverlay","currentOverlayName","updateStoredProgress","setShowEnding","StateContext","React","createContext","undefined","StateProvider","children","stateHooks","Provider","value","useStateHooks","useContext","useEvents","evntName","callback","eventsManager","context","unsubscribeEvent","addEventListener","eventPayload","SVGElement","HTMLInputElement","defaultInstanceSettings","update","begin","loopBegin","changeBegin","change","changeComplete","loopComplete","complete","loop","direction","autoplay","timelineOffset","defaultTweenSettings","duration","delay","endDelay","easing","round","cache","CSS","springs","minMax","val","min","max","Math","stringContains","str","text","indexOf","applyArguments","func","args","apply","is","arr","Array","isArray","obj","Object","prototype","toString","call","pth","svg","inp","dom","nodeType","fnc","und","hex","test","rgb","hsl","col","key","parseEasingParameters","string","match","exec","split","map","p","parseFloat","spring","params","mass","stiffness","damping","velocity","w0","sqrt","zeta","wd","b","solver","t","progress","exp","cos","sin","cached","elapsed","rest","steps","ceil","bezier","A","aA1","aA2","B","C","calcBezier","aT","getSlope","mX1","mY1","mX2","mY2","sampleValues","Float32Array","i","x","getTForX","aX","intervalStart","currentSample","kSplineTableSize","guessForT","initialSlope","aGuessT","currentSlope","newtonRaphsonIterate","aA","aB","currentX","currentT","abs","binarySubdivide","penner","eases","linear","functionEasings","Sine","PI","Circ","Back","Bounce","pow2","pow","Elastic","amplitude","period","asin","forEach","keys","easeIn","parseEasings","ease","filterArray","len","length","thisArg","arguments","push","flattenArray","reduce","concat","toArray","o","arrayContains","some","cloneObject","clone","replaceObjectProps","o1","o2","mergeObjects","colorToRgb","rgbValue","rgbToRgba","hexValue","replace","m","r","g","parseInt","hexToRgba","hslValue","h","s","l","hue2rgb","q","hslToRgba","getUnit","getFunctionValue","animatable","target","id","total","getAttribute","el","prop","convertPxToUnit","unit","appendChild","style","position","width","factor","offsetWidth","removeChild","convertedUnit","getElementTransforms","transform","reg","transforms","Map","set","getOriginalTargetValue","propName","getRelativeValue","to","from","operator","u","y","validateValue","originalUnit","unitLess","substr","getDistance","p1","p2","getPolylineLength","previousPos","points","totalLength","numberOfItems","currentPos","getTotalLength","tagName","toLowerCase","getCircleLength","getRectLength","getLineLength","getPolygonLength","getParentSvg","pathEl","svgData","parentSvgEl","parentEl","parentNode","getParentSvgEl","rect","getBoundingClientRect","viewBoxAttr","height","viewBox","w","getPathProgress","path","point","offset","getPointAtLength","p0","property","atan2","decomposeValue","rgx","original","numbers","strings","parseTargets","targets","item","pos","self","getAnimatables","parsed","list","normalizePropertyTweens","tweenSettings","settings","propArray","v","k","getProperties","properties","keyframes","propertyNames","newKey","flattenKeyframes","tweens","normalizeTweens","previousTween","tween","normalizeTweenValues","tweenValue","toUnit","originalValue","previousValue","fromUnit","start","end","isPath","isColor","setProgressValue","css","attribute","setAttribute","object","manual","last","setTargetsValue","valueUnit","getAnimations","animatables","animType","lastTween","createAnimation","getInstanceTimings","animations","animLength","getTlOffset","anim","timings","instanceID","createNewInstance","instanceSettings","raf","activeInstances","engine","play","requestAnimationFrame","step","activeInstancesLength","activeInstance","paused","instanceIndex","splice","tick","cancelAnimationFrame","anime","startTime","lastTime","now","childrenLength","resolve","makePromise","instance","promise","Promise","_resolve","finished","toggleInstanceDirection","reversed","child","adjustTime","time","resetTime","currentTime","speed","seekChild","seek","syncInstanceChildren","reversePlayback","setAnimationsProgress","insTime","animationsLength","tweenLength","eased","isNaN","toNumbersLength","n","toNumber","fromNumber","stringsLength","currentValue","setCallback","cb","passThrough","countIteration","remaining","setInstanceProgress","engineTime","insDuration","insDelay","insEndDelay","began","loopBegan","changeBegan","changeCompleted","completed","reset","pause","reverse","restart","removeTargetsFromAnimations","targetsArray","version","running","remove","c","childAnimations","get","convertPx","percent","e","selectString","setDashoffset","pathLength","stagger","grid","axis","fromIndex","fromFirst","fromCenter","fromLast","isRange","val1","val2","values","maxValue","index","fromX","fromY","floor","distanceX","distanceY","timeline","tl","add","instanceParams","tlIndex","ins","insParams","tlDuration","random","CountDown","useState","count","setCount","setStart","gameReadyTrigger","systemOnlineTrigger","camera","useThree","tId","useRef","current","setTimeout","destination","z","lookAt","targetObj","Dimensions","scale","useAspect","Html","scaleFactor","calculatePosition","minWidth","minHeight","className","display","color","fontFamily","fontWeight","flexBasis","boxSizing","flexDirection","alignItems","justifyContent","fontSize","useKeyPress","targetKey","keyPressed","setKeyPressed","downHandler","upHandler","window","removeEventListener","KEY_THROTTLE_BY_PLAYER_INDEX","0","1","SCREEN_POS_BY_PLAYER_INDEX","posX","posY","COLORS_BY_PLAYER_INDEX","player","controller","Controllers","forPlayers","noUI","players","refs","playersConfig","idx","keyboardThrottle","isThrottling","hit","usePlayers","SS_controller_p2_throttle","handleTouchStart","nativeEvent","touches","hitAreaPlayers","checkTouchOnPlayerAreas","evt","ha","doubleTap","handleTouchEnd","useHitArea","P1ThrottleKeyPressed","P2ThrottleKeyPressed","oncontextmenu","event","preventDefault","stopPropagation","Fragment","View","onTouchStart","onTouchEnd","onMouseDown","onMouseUp","zIndex","bottom","right","src","mainButton","loaderObj","OBJLoader","loaderMtl","MTLLoader","forwardRef","THREE","TextureLoader","props","ref","fwdRef","geometry","setGeometry","texture","tint","moreProps","materialPurple","MeshLambertMaterial","materialStone","Color","darken","materialStoneDark","mtl","preload","setMaterials","material","receiveShadow","Text","anchorX","anchorY","MeshBasicMaterial","opacity","transparent","toUpperCase","b2FixtureDef","Box2D","Dynamics","b2BodyDef","b2Body","b2Vec2","Common","shapes","circle","Collision","Shapes","b2CircleShape","box","b2PolygonShape","useApi","world","destroyQueue","impulse","uuid","body","GetUserData","freeze","SetUserData","rotate","userData","unfreeze","destroy","originPosition","origin","console","log","SetLinearVelocity","SetTransform","GetAngle","f","GetFixtureList","GetNext","SetSensor","createCharacter","fixtureDef","shape","bodyDef","static","b2_staticBody","b2_dynamicBody","SetRadius","radius","SetAsBox","hx","hy","density","friction","restitution","isSensor","pickable","linearDamping","bullet","Set","angle","CreateBody","CreateFixture","spinFactor","grow","m_shape","m_radius","hulk","revertSpin","overchargePower","coil","dischargePower","overchargeFreezer","freezer","dischargeFreeze","hyperJump","outOfThisWorld","getPhysicsUserData","useBody","config","localRef","api","useCircle","useBox","textureLoader","colorPalette","threeTone","load","require","minFilter","NearestFilter","magFilter","materialChassis","MeshToonMaterial","gradientMap","materialDeco","materialCore","materialDome","castShadow","useMemo","PALETTES","2","3","4","SmokeInstances","originMeshRef","seed","sphereRefs","range","center","initialPositions","useFrame","INCREMENT","Model","isFreezed","setFreezed","emote","setEmote","MeshNormalMaterial","wireframe","side","BackSide","powerMaterial","emoteTimerId","powerRef","ufoRef","orignalColors","baseRef","PICK_CRYSTAL_GROW","growOverchargeSphere","visible","detached","emoteSwirl","clearTimeout","Shape","moveTo","lineTo","UfoModel","indicatorGeometry","ShapeGeometry","times","animation","indicatorColor","indicatorOffset","model","Ufo","Ufo2","Ufo3","Ufo4","indicatorMaterial","fallback","dispose","backgroundColor","marginTop","marginLeft","rotation","degToRad","useOutOfTheBox","elementRef","isOut","setIsOut","outFromLeft","outFromRight","outFromTop","outFromBottom","isOutOfArena","animateFallUp","onComplete","transformation","positionY","Player","externalRef","userController","outOfRing","triggerOutOfRing","triggerImpulseOn","triggerImpulseOff","unsubscribeControllerOn","unsubscribeControllerOff","unsubscribeControllerRestart","unsubscribeControllerDoubleTap","isPlayer","spinSpeed","respawnMe","useCollision","subscribe","CollisionsManager","onCollide","bind","useLayoutEffect","unsubscribe","Enemy","enemies","spin","impulseRef","impulseTID","retargetTID","setTarget","lookObject","Object3D","stopImpulse","forceTo","aggressiveness","getAggressivenessByModel","wanderness","getWandernessByModel","Vector3","copy","getReflexesByModel","myself","impulseDuration","rotateY","quaternion","angleTo","flagSafeTurn","turns","setTurns","originalAngle","setOriginalAngle","active","setActive","useTurnsCounter","UfoShip","isEnemy","b2RayCastOutput","fixtureIsCharacter","fix","GetBody","isDirectHit","fixA","fixB","rayCastOutput","bodyA","GetPosition","bodyAPosX","bodyAPosY","dest","Add","rayInput","maxFraction","RayCast","isOvercharged","applyExtraImpulse","bodyB","extraPower","impulseVector","ApplyImpulse","GetWorldCenter","applyOverchargeCoil","posA","posB","Copy","Subtract","Normalize","HitPhysics","b2Contact","GetFixtureA","GetFixtureB","isDirectHitAtoB","isDirectHitBtoA","directHitAtoB","directHitBtoA","bodyAData","bodyBData","Date","hitBy","hitByTime","hitByDirect","setHitBy","EventsManager","overchargeReaction","b2World","b2ContactListener","onReady","setWorld","Clock","clock","IsLocked","newPos","CharactersLoop","getDelta","Step","DestroyBody","pop","gravity","contactListener","BeginContact","dispatchOnBeginContact","EndContact","dispatchOnEndContact","SetContactListener","SetContinuousPhysics","onEndContact","bodies","Physics","levels","arena","walls","crystals","timeToAppear","crystalMinTimeToAppear","spinReverseAreas","portalGroups","COLORS_BY_TYPE","hide","show","playerRef","passProps","setStep","circleRef","triggerOnPickCoil","triggerOnPickFreezer","triggerOnPickGrow","triggerOnOvercharge","collidedFixture","colorMaterial","animationLoop","RingGeometry","LineBasicMaterial","isWall","spinRevertTrigger","materials","DoubleSide","Portals","positionBlue","positionRed","portalBlue","portalRed","teleporting","onTeleportTrigger","includes","filter","UfoBase","fill","EventsService","player1","player2","playersOnArena","useLevels","levelId","sounds","setSounds","createSoundAsync","asset","Audio","Sound","createAsync","sound","arena_completed","arena_won","loadSounds","playSound","soundId","replayAsync","CURRENT_LEVEL","LEVELS","enemyRefs","wallRefs","characterRef","isUserFall","playersAlive","pRef","thereArePlayersLeft","onlyOnePlayersLeft","userIsAlive","find","ReactNativeWebView","postMessage","ENEMY_DOWN","GAME_OVER","enemy","wall","Wall","crystal","Crystal","portals","area","RevertSpinArea","GamePlay","onLoad","onEnd","simpleHit","teleport","coil_discharge","crystal_pick","freezeEffect","gameplay","contact","fixtureA","fixtureB","dataA","dataB","World","background","margin","shadows","fov","concurrent","gl","antialias","onCreated","intensity","distance","shadow-mapSize-width","shadow-mapSize-height","shadow-camera-far","shadow-camera-left","shadow-camera-right","shadow-camera-top","shadow-camera-bottom","Stars","this","clamp","multiply","matrix","newR","newG","newB","slope","intercept","d","Solver","baseColor","targetHSL","reusedColor","solveNarrow","solveWide","loss","best","Infinity","spsa","wide","A1","iters","bestLoss","deltas","highArgs","lowArgs","ck","lossDiff","ak","slice","filters","invert","sepia","saturate","hueRotate","brightness","contrast","colorHSL","fmt","multiplier","computeFilters","hexcolor","hexToRgb","solve","alert","onSelect","flexWrap","maxWidth","arenaWon","currentArena","onClick","arenaIconMask","arenaIcon","visibility","lockIcon","top","left","trophyIcon","arrowIcon","ScreenManager","setScreen","selectedLevel","setSelectedLevel","msgKey","eventName","location","reload","isGameCompleted","maxHeight","Home","onPlay","onRestart","LevelSelection","registerRootComponent","service","onBeginContact","filterUUID","isRelevantCollistion","collideAgainstFixture","lazy","WorldEvents","callbacks","data"],"mappings":"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","file":"static/js/app.5cce92ce.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAADcUlEQVR42u2dLY8iQRCGR548ufLkSeQYEgRiEwwJZgQCQ7ISufIEyclLMKvIypPIlfyETTArcazEkBC+cjfvZGbT7A4wX11V3dOTlNgEZnqe7arqrqouPI/xWq/X37fb7Y/D4dAK5f54PA6yCD673+99fBf38Opy4WXx4iGEIJTR6XT6VYXgXrgn7r1cLr9ZBQ0vFL5YI3zBh6qAZQA6wDONn21QtfCFHqnApcgjzINRao7BYgYwQksV/DNFg4SqCphxN2ekSDu52WzuqnQKBDZyhDGLgBcOpmsKuM+C2ciqspSeVeNsfCBX6VhljYenQiRTaTxIuKMo7GC0Q8QywFJ4HxC1LXVssXksNrEu8LRBxEa9LvAUiEHt13kVQOyWgoeIRl3hKYvthvO4HJ5ZYkSFUZUHeVXXd+AK7pvhvp3qpqtypqVNHNNzwC4EZbM4DhGDHY/HL71eb5kI/pYwrqsOBfkDCYOcz+dPvu//+ywSIIKRaNsHeM1mc5sGEDKZTGYibaGERfMteFIgpi6uuYMFWeElMp1O/3IGG0Q5j7zwIPg8vifCmXAunIvAkwDxbGHNFa4qA48b4lm4y1R43BDVJJGx8DghRkkoavunAx4XxMgOUu59dcJTIS4Wiz9ke2OquB8FvEQ6nc77arX6TRInpABICY8SYgTQRniUELUCxODb7faaAx4VRK0Ah8PhKye8RBBPNBKgBHiJOIB1BNjv998kwIMpMRLgbDZ75vLAqujcnXi6i8MBEZ6QAxxWAHi+zmJ19goEyfYt604kcABLxAS5U5kmA4xSnNzZOJMBRtk5joCqLQA/qvodwBIhfe4aaFMBniWVONOapgI8S2tyJtZNBfilSourtMNEgF9KOzjV2ESAqeW+cXmbA5hBLpb6chyqQbS4bBpTzOEbDmeCaEmZvAl1reDNMyN1PtpVydEvd0KpghNLUorNhR1xaOU96jVy4JTIc8HeCA6gGnXJezlVLqC67tRmiVOarl+Cpr4JFveKoeshUyOI+hrw2NbyiaUFlK02kbQJmW0QWTq4xRAHFsALWDtaGtD281o7UBmdfl0L0Gqb0Lq2nxXMxkBiMFTcrLt2oc+9BJDGgbvQ0bxF6Whg4/BM6/rqxz31uzocTgztfrfb/fTqcMW/7NBQfgZjlAeW8rMYDc4W7/8BSYBkOHCJRBIAAAAtdEVYdFNvZnR3YXJlAGJ5LmJsb29kZHkuY3J5cHRvLmltYWdlLlBORzI0RW5jb2RlcqgGf+4AAAAASUVORK5CYII=\"","export const CHARACTER_EVENTS = {\n  // the character is out of arena\n  OUT_OF_RING: 'out_of_ring',\n  BEGIN_CONTACT: 'on_begin_contact',\n  END_CONTACT: 'on_end_contact',\n  OVERCHARGE: 'on_overcharge',\n  DISCHARGE: 'on_discharge',\n  GETS_FREEZER: 'on_get_freezer_hit',\n  UNFREEZE: 'on_unfreeze',\n  GETS_COIL: 'on_get_coil_hit',\n  PICK_CRYSTAL_FREEZER: 'on_pick_crystal_freezer',\n  PICK_CRYSTAL_HULK: 'on_pick_crystal_hulk',\n  PICK_CRYSTAL_COIL: 'on_pick_crystal_coil',\n  EXTERNAL_SPIN_CHANGE: 'on_external_force_change_spin',\n  TELEPORT: 'on_teleport_use',\n  IMPULSE_ON: 'on_impulse_itself',\n  IMPULSE_OFF: 'on_stop_impulse_itself'\n}\n\nexport const GAME_EVENTS = {\n  READY_ON: 'gameplay_ready_on',\n  READY_OFF: 'gameplay_ready_off',\n  SYSTEM_ONLINE: 'gameplay_system_is_online',\n}","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAmCAMAAACS/WnbAAAABGdBTUEAALGPC/xhBQAAAGlQTFRF////////6urq5eXl4uLi8PDw9fX1////+vr6/v7+/v7+////AAAAi4iI9fX1ZGFh8PDwy8rKcW5usbCw8vHxfnt7pKOj6+vrmJaWV1RU5eTkSkdH5ubm2NfXPTo6vr294uLiMS0t////KmhJ/QAAAA10Uk5TX++fn5+fn4+f379/AN3SnhMAAAD5SURBVDjLzZNrF4IgDIbpXrYuCJpoQOz//8g26pgnkL72fvDo9rC9TBAgqgpnVFUCxBGLOopFGVgI/KG/A3zjgmn1HGBNiHKnPNCFUUZnAE+JgcqrC73UKdA7CmvsLWJLRJsADa1HS1RQ3MwlwBCC1y46UFjz4wugBKqXxYH91DmAmxsqZenrkmkhe/ZPBmTEU5NG+67j3dgcwKuNl9LwDmymxWSQnsu16aibd15xAWqT/qz+RE4HGYfalM5DNy2QAzzb+K9DeyjnD78vL+xK+R0IGLV+jFp/ohMAVve3VpAHYHmLWsIcAJsraQPzAGzP5y2UANjvvwJPs7+MIdFXRVwAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/icon.e87ea239.png\";","module.exports = __webpack_public_path__ + \"static/media/icon_mask.71bfa3b7.png\";","module.exports = __webpack_public_path__ + \"static/media/locked.acc43305.png\";","module.exports = __webpack_public_path__ + \"static/media/trophy.62b42f48.png\";","module.exports = __webpack_public_path__ + \"static/media/arrowDown.c6142cd3.png\";","module.exports = __webpack_public_path__ + \"static/media/arena_completed.57d54f49.mp3\";","module.exports = __webpack_public_path__ + \"static/media/arena_won.99ffa4e1.mp3\";","module.exports = __webpack_public_path__ + \"static/media/ufoHit.bb9b0b7d.mp3\";","module.exports = __webpack_public_path__ + \"static/media/teleport.78d9ec30.mp3\";","module.exports = __webpack_public_path__ + \"static/media/coil_discharge.313fb7a7.mp3\";","module.exports = __webpack_public_path__ + \"static/media/crystal_pick.3c0740fb.mp3\";","module.exports = __webpack_public_path__ + \"static/media/grow.66ce11d8.mp3\";","module.exports = __webpack_public_path__ + \"static/media/freezeEffect.d4557efe.mp3\";","module.exports = __webpack_public_path__ + \"static/media/gameplay.38c35bcd.mp3\";","import AsyncStorage from '@react-native-async-storage/async-storage';\n\nexport const setStateToStorage = state => AsyncStorage.setItem('@state', JSON.stringify(state))\nexport const getStateFromStorage = async () => {\n  const storedValue = await AsyncStorage.getItem('@state')\n  return storedValue ? JSON.parse(storedValue) : null\n}\n\nexport const setSFXVolumeToStorage = volume => AsyncStorage.setItem('@SFXVolume', JSON.stringify(volume))\nexport const getSFXVolumeFromStorage = async () => {\n  const storedValue = await AsyncStorage.getItem('@SFXVolume')\n  return storedValue ? JSON.parse(storedValue) : 0.5\n}\n\nexport const setMFXVolumeToStorage = volume => AsyncStorage.setItem('@MFXVolume', JSON.stringify(volume))\nexport const getMFXVolumeFromStorage = async () => {\n  const storedValue = await AsyncStorage.getItem('@MFXVolume')\n  return storedValue ? JSON.parse(storedValue) : 0.5\n}","import { setStateToStorage } from './storage'\n\nexport const initialState = {\n  screen: 'titles',\n  overlay: '',\n  currentLevel: 0,\n  // temporary position to display final arena overlay (podium)\n  latestArenaResult: Number.MAX_SAFE_INTEGER,\n  showEnding: false,\n  arenas:[{\n    type: 'granite',\n    locked: false,\n    name: 'Granite',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'sand',\n    locked: true,\n    name: 'Sand',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'malachite',\n    locked: true,\n    name: 'Malaquite',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'turquoise',\n    locked: true,\n    name: 'Turquoise',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'aragonite',\n    locked: true,\n    name: 'Aragonite',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'jasper',\n    locked: true,\n    name: 'Jasper',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'amethyst',\n    locked: true,\n    name: 'Amethyst',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'topaz',\n    locked: true,\n    name: 'Topaz',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'sulfur',\n    locked: true,\n    name: 'Sulfur',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'graphite',\n    locked: true,\n    name: 'Graphite',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'graphite',\n    locked: true,\n    name: 'The roof',\n    result: Number.MAX_SAFE_INTEGER,\n  }, {\n    type: 'graphite',\n    locked: true,\n    name: 'The castle',\n    result: Number.MAX_SAFE_INTEGER,\n  }]\n}\n\nconst app = (state, action) => {\n  const switchObj = {\n    NAVIGATE: () => ({\n      ...state,\n      screen: action.payload,\n    }),\n    SET_CURRENT_LEVEL: () => ({\n      ...state,\n      currentLevel: action.payload,\n    }),\n    SET_SHOW_ENDING: () => ({\n      ...state,\n      showEnding: action.payload,\n    }),\n    SET_ARENA_RESULT: () => {\n      const arenas = [...state.arenas]\n      const { arenaIndex, result } = action.payload\n      // updates only best position\n      const bestForArena = arenas[arenaIndex].result || Number.MAX_SAFE_INTEGER\n      if (result < bestForArena) {\n        arenas[arenaIndex].result = result\n      }\n      if (result <= 3 && arenas[arenaIndex + 1]) {\n        // arena complete, unlock next arena\n        arenas[arenaIndex + 1].locked = false\n      }\n      return {\n        ...state,\n        latestArenaResult: result,\n        arenas,\n      }\n    },\n    SET_OVERLAY: () => ({\n      ...state,\n      overlay: action.payload,\n    }),\n    UPDATE_STORED_PROGRESS: () => ({\n      ...state,\n      arenas: action.payload\n    }),\n    UPDATE_STATE_FROM_STORAGE: () => ({\n      ...action.payload\n    }),\n    DEFAULT: () => ({ ...state })\n  }\n  // switch (action.type) {\n  //   case \"NAVIGATE\":\n  //     stateObj = {\n  //       ...state,\n  //       screen: action.payload,\n  //     };\n  //   case \"SET_CURRENT_LEVEL\":\n  //     stateObj = {\n  //       ...state,\n  //       currentLevel: action.payload,\n  //     }\n  //   case \"SET_ARENA_RESULT\":\n  //     const arenas = [...state.arenas]\n  //     const { arenaIndex, result } = action.payload\n  //     // updates only best position\n  //     const bestForArena = arenas[arenaIndex].result || Number.MAX_SAFE_INTEGER\n  //     if (result < bestForArena) {\n  //       arenas[arenaIndex].result = result\n  //     }\n  //     if (result <= 3) {\n  //       // arena complete, unlock next arena\n  //       arenas[arenaIndex + 1].locked = false\n  //     }\n  //     stateObj = {\n  //       ...state,\n  //       latestArenaResult: result,\n  //       arenas,\n  //     }\n  //   case \"SET_OVERLAY\":\n  //     stateObj = {\n  //       ...state,\n  //       overlay: action.payload,\n  //     }\n  //   default:\n  //     stateObj = state\n  // }\n  const newState = switchObj.hasOwnProperty(action.type) ? switchObj[action.type]() : switchObj.DEFAULT()\n  setStateToStorage(newState)\n  return newState\n};\n\nexport default app\n","import { useEffect, useReducer, useState } from 'react'\nimport stateReducer from \"./reducers\";\nimport stateActions from \"./actions\";\nimport { initialState } from \"./reducers\"\nimport { getStateFromStorage } from './storage';\n\nexport default function useStateManager() {\n  useEffect(() => {\n    const loadStore = async () => {\n      const state = await getStateFromStorage()\n      actions.updateStateFromStorage(state || initialState)\n      // actions.updateStoredProgress(state?.arenas ? state.arenas : initialState.arenas)\n    }\n    loadStore()\n  },[])\n  const [state, stateDispatch] = useReducer(stateReducer, initialState);\n  const actions = stateActions(stateDispatch);\n  \n  return {\n    state,\n    ...actions,\n  };\n}\n","export default function todoActions(dispatch) {\n  function navigate(payload) {\n    dispatch({\n      type: \"NAVIGATE\",\n      payload\n    });\n  }\n  function setCurrentLevel(payload) {\n    dispatch({\n      type: \"SET_CURRENT_LEVEL\",\n      payload\n    });\n  }\n  function setArenaResult(arenaIndex, result) {\n    dispatch({\n      type: \"SET_ARENA_RESULT\",\n      payload: { arenaIndex, result }\n    });\n  }\n  function setShowEnding(state) {\n    dispatch({\n      type: \"SET_SHOW_ENDING\",\n      payload: state\n    });\n  }\n  function showOverlay(currentOverlayName) {\n    dispatch({\n      type: \"SET_OVERLAY\",\n      payload: currentOverlayName\n    });\n  }\n  function updateStateFromStorage(state) {\n    dispatch({\n      type: 'UPDATE_STATE_FROM_STORAGE',\n      payload: state\n    })\n  }\n  function updateStoredProgress(arenas) {\n    dispatch({\n      type: 'UPDATE_STORED_PROGRESS',\n      payload: arenas\n    })\n  }\n\n  return {\n    navigate,\n    setCurrentLevel,\n    setArenaResult,\n    showOverlay,\n    updateStoredProgress,\n    updateStateFromStorage,\n    setShowEnding,\n  }\n}\n","import React, { useContext } from \"react\";\nimport useStateManager from \"./index\";\n\nconst StateContext = React.createContext(undefined);\n\nexport const StateProvider = ({ children }) => {\n  const stateHooks = {\n    app: useStateManager()\n  };\n  return (\n    <StateContext.Provider value={stateHooks}>\n      {children}\n    </StateContext.Provider>\n  );\n};\n// curry the Context\nexport const useStateHooks = () => {\n  return useContext(StateContext);\n};","import React, { useContext, useEffect } from 'react'\nimport { context } from './index'\n\nexport function useEvents (evntName, callback) {\n  const eventsManager = useContext(context)\n  useEffect(() => {\n    let unsubscribeEvent\n    if (callback) {\n      unsubscribeEvent = eventsManager.addEventListener(evntName, callback)\n    }\n    \n    return () => {\n      unsubscribeEvent && unsubscribeEvent()\n    }\n  },[evntName, callback])\n\n  return eventPayload => eventsManager.dispatch(evntName, eventPayload)\n}","// Defaults\nclass SVGElement {}\nclass HTMLInputElement {}\nclass NodeList {}\nclass HTMLCollection {}\n\nconst defaultInstanceSettings = {\n  update: null,\n  begin: null,\n  loopBegin: null,\n  changeBegin: null,\n  change: null,\n  changeComplete: null,\n  loopComplete: null,\n  complete: null,\n  loop: 1,\n  direction: 'normal',\n  autoplay: true,\n  timelineOffset: 0\n}\n\nconst defaultTweenSettings = {\n  duration: 1000,\n  delay: 0,\n  endDelay: 0,\n  easing: 'easeOutElastic(1, .5)',\n  round: 0\n}\n\nconst validTransforms = ['translateX', 'translateY', 'translateZ', 'rotate', 'rotateX', 'rotateY', 'rotateZ', 'scale', 'scaleX', 'scaleY', 'scaleZ', 'skew', 'skewX', 'skewY', 'perspective', 'matrix', 'matrix3d'];\n\n// Caching\n\nconst cache = {\n  CSS: {},\n  springs: {}\n}\n\n// Utils\n\nfunction minMax(val, min, max) {\n  return Math.min(Math.max(val, min), max);\n}\n\nfunction stringContains(str, text) {\n  return str.indexOf(text) > -1;\n}\n\nfunction applyArguments(func, args) {\n  return func.apply(null, args);\n}\n\nconst is = {\n  arr: a => Array.isArray(a),\n  obj: a => stringContains(Object.prototype.toString.call(a), 'Object'),\n  pth: a => is.obj(a) && a.hasOwnProperty('totalLength'),\n  svg: a => a instanceof SVGElement,\n  inp: a => a instanceof HTMLInputElement,\n  dom: a => a.nodeType || is.svg(a),\n  str: a => typeof a === 'string',\n  fnc: a => typeof a === 'function',\n  und: a => typeof a === 'undefined',\n  hex: a => /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a),\n  rgb: a => /^rgb/.test(a),\n  hsl: a => /^hsl/.test(a),\n  col: a => (is.hex(a) || is.rgb(a) || is.hsl(a)),\n  key: a => !defaultInstanceSettings.hasOwnProperty(a) && !defaultTweenSettings.hasOwnProperty(a) && a !== 'targets' && a !== 'keyframes'\n}\n\n// Easings\n\nfunction parseEasingParameters(string) {\n  const match = /\\(([^)]+)\\)/.exec(string);\n  return match ? match[1].split(',').map(p => parseFloat(p)) : [];\n}\n\n// Spring solver inspired by Webkit Copyright  2016 Apple Inc. All rights reserved. https://webkit.org/demos/spring/spring.js\n\nfunction spring(string, duration) {\n\n  const params = parseEasingParameters(string);\n  const mass = minMax(is.und(params[0]) ? 1 : params[0], .1, 100);\n  const stiffness = minMax(is.und(params[1]) ? 100 : params[1], .1, 100);\n  const damping = minMax(is.und(params[2]) ? 10 : params[2], .1, 100);\n  const velocity = minMax(is.und(params[3]) ? 0 : params[3], .1, 100);\n  const w0 = Math.sqrt(stiffness / mass);\n  const zeta = damping / (2 * Math.sqrt(stiffness * mass));\n  const wd = zeta < 1 ? w0 * Math.sqrt(1 - zeta * zeta) : 0;\n  const a = 1;\n  const b = zeta < 1 ? (zeta * w0 + -velocity) / wd : -velocity + w0;\n\n  function solver(t) {\n    let progress = duration ? (duration * t) / 1000 : t;\n    if (zeta < 1) {\n      progress = Math.exp(-progress * zeta * w0) * (a * Math.cos(wd * progress) + b * Math.sin(wd * progress));\n    } else {\n      progress = (a + b * progress) * Math.exp(-progress * w0);\n    }\n    if (t === 0 || t === 1) return t;\n    return 1 - progress;\n  }\n\n  function getDuration() {\n    const cached = cache.springs[string];\n    if (cached) return cached;\n    const frame = 1 / 6;\n    let elapsed = 0;\n    let rest = 0;\n    while (true) {\n      elapsed += frame;\n      if (solver(elapsed) === 1) {\n        rest++;\n        if (rest >= 16) break;\n      } else {\n        rest = 0;\n      }\n    }\n    const duration = elapsed * frame * 1000;\n    cache.springs[string] = duration;\n    return duration;\n  }\n\n  return duration ? solver : getDuration;\n\n}\n\n// Basic steps easing implementation https://developer.mozilla.org/fr/docs/Web/CSS/transition-timing-function\n\nfunction steps(steps = 10) {\n  return t => Math.ceil((minMax(t, 0.000001, 1)) * steps) * (1 / steps);\n}\n\n// BezierEasing https://github.com/gre/bezier-easing\n\nconst bezier = (() => {\n\n  const kSplineTableSize = 11;\n  const kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\n  function A(aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1 };\n  function B(aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1 };\n  function C(aA1) { return 3.0 * aA1 };\n\n  function calcBezier(aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT };\n  function getSlope(aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1) };\n\n  function binarySubdivide(aX, aA, aB, mX1, mX2) {\n    let currentX, currentT, i = 0;\n    do {\n      currentT = aA + (aB - aA) / 2.0;\n      currentX = calcBezier(currentT, mX1, mX2) - aX;\n      if (currentX > 0.0) { aB = currentT } else { aA = currentT };\n    } while (Math.abs(currentX) > 0.0000001 && ++i < 10);\n    return currentT;\n  }\n\n  function newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n    for (let i = 0; i < 4; ++i) {\n      const currentSlope = getSlope(aGuessT, mX1, mX2);\n      if (currentSlope === 0.0) return aGuessT;\n      const currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n      aGuessT -= currentX / currentSlope;\n    }\n    return aGuessT;\n  }\n\n  function bezier(mX1, mY1, mX2, mY2) {\n\n    if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) return;\n    let sampleValues = new Float32Array(kSplineTableSize);\n\n    if (mX1 !== mY1 || mX2 !== mY2) {\n      for (let i = 0; i < kSplineTableSize; ++i) {\n        sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n      }\n    }\n\n    function getTForX(aX) {\n\n      let intervalStart = 0;\n      let currentSample = 1;\n      const lastSample = kSplineTableSize - 1;\n\n      for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n        intervalStart += kSampleStepSize;\n      }\n\n      --currentSample;\n\n      const dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n      const guessForT = intervalStart + dist * kSampleStepSize;\n      const initialSlope = getSlope(guessForT, mX1, mX2);\n\n      if (initialSlope >= 0.001) {\n        return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n      } else if (initialSlope === 0.0) {\n        return guessForT;\n      } else {\n        return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n      }\n\n    }\n\n    return x => {\n      if (mX1 === mY1 && mX2 === mY2) return x;\n      if (x === 0 || x === 1) return x;\n      return calcBezier(getTForX(x), mY1, mY2);\n    }\n\n  }\n\n  return bezier;\n\n})();\n\nconst penner = (() => {\n\n  // Based on jQuery UI's implemenation of easing equations from Robert Penner (http://www.robertpenner.com/easing)\n\n  const eases = { linear: () => t => t };\n\n  const functionEasings = {\n    Sine: () => t => 1 - Math.cos(t * Math.PI / 2),\n    Circ: () => t => 1 - Math.sqrt(1 - t * t),\n    Back: () => t => t * t * (3 * t - 2),\n    Bounce: () => t => {\n      let pow2, b = 4;\n      while (t < ((pow2 = Math.pow(2, --b)) - 1) / 11) { };\n      return 1 / Math.pow(4, 3 - b) - 7.5625 * Math.pow((pow2 * 3 - 2) / 22 - t, 2)\n    },\n    Elastic: (amplitude = 1, period = .5) => {\n      const a = minMax(amplitude, 1, 10);\n      const p = minMax(period, .1, 2);\n      return t => {\n        return (t === 0 || t === 1) ? t :\n          -a * Math.pow(2, 10 * (t - 1)) * Math.sin((((t - 1) - (p / (Math.PI * 2) * Math.asin(1 / a))) * (Math.PI * 2)) / p);\n      }\n    }\n  }\n\n  const baseEasings = ['Quad', 'Cubic', 'Quart', 'Quint', 'Expo'];\n\n  baseEasings.forEach((name, i) => {\n    functionEasings[name] = () => t => Math.pow(t, i + 2);\n  });\n\n  Object.keys(functionEasings).forEach(name => {\n    const easeIn = functionEasings[name];\n    eases['easeIn' + name] = easeIn;\n    eases['easeOut' + name] = (a, b) => t => 1 - easeIn(a, b)(1 - t);\n    eases['easeInOut' + name] = (a, b) => t => t < 0.5 ? easeIn(a, b)(t * 2) / 2 :\n      1 - easeIn(a, b)(t * -2 + 2) / 2;\n  });\n\n  return eases;\n\n})();\n\nfunction parseEasings(easing, duration) {\n  if (is.fnc(easing)) return easing;\n  const name = easing.split('(')[0];\n  const ease = penner[name];\n  const args = parseEasingParameters(easing);\n  switch (name) {\n    case 'spring': return spring(easing, duration);\n    case 'cubicBezier': return applyArguments(bezier, args);\n    case 'steps': return applyArguments(steps, args);\n    default: return applyArguments(ease, args);\n  }\n}\n\n// Strings\n\nfunction selectString(str) {\n  try {\n    // let nodes = document.querySelectorAll(str);\n    return str;\n  } catch (e) {\n    return;\n  }\n}\n\n// Arrays\n\nfunction filterArray(arr, callback) {\n  const len = arr.length;\n  const thisArg = arguments.length >= 2 ? arguments[1] : void 0;\n  const result = [];\n  for (let i = 0; i < len; i++) {\n    if (i in arr) {\n      const val = arr[i];\n      if (callback.call(thisArg, val, i, arr)) {\n        result.push(val);\n      }\n    }\n  }\n  return result;\n}\n\nfunction flattenArray(arr) {\n  return arr.reduce((a, b) => a.concat(is.arr(b) ? flattenArray(b) : b), []);\n}\n\nfunction toArray(o) {\n  if (is.arr(o)) return o;\n  // if (is.str(o)) o = selectString(o) || o;\n  // if (o instanceof NodeList || o instanceof HTMLCollection) return [].slice.call(o);\n  return [o];\n}\n\nfunction arrayContains(arr, val) {\n  return arr.some(a => a === val);\n}\n\n// Objects\n\nfunction cloneObject(o) {\n  const clone = {};\n  for (let p in o) clone[p] = o[p];\n  return clone;\n}\n\nfunction replaceObjectProps(o1, o2) {\n  const o = cloneObject(o1);\n  for (let p in o1) o[p] = o2.hasOwnProperty(p) ? o2[p] : o1[p];\n  return o;\n}\n\nfunction mergeObjects(o1, o2) {\n  const o = cloneObject(o1);\n  for (let p in o2) o[p] = is.und(o1[p]) ? o2[p] : o1[p];\n  return o;\n}\n\n// Colors\n\nfunction rgbToRgba(rgbValue) {\n  const rgb = /rgb\\((\\d+,\\s*[\\d]+,\\s*[\\d]+)\\)/g.exec(rgbValue);\n  return rgb ? `rgba(${rgb[1]},1)` : rgbValue;\n}\n\nfunction hexToRgba(hexValue) {\n  const rgx = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  const hex = hexValue.replace(rgx, (m, r, g, b) => r + r + g + g + b + b);\n  const rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  const r = parseInt(rgb[1], 16);\n  const g = parseInt(rgb[2], 16);\n  const b = parseInt(rgb[3], 16);\n  return `rgba(${r},${g},${b},1)`;\n}\n\nfunction hslToRgba(hslValue) {\n  const hsl = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.exec(hslValue) || /hsla\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%,\\s*([\\d.]+)\\)/g.exec(hslValue);\n  const h = parseInt(hsl[1], 10) / 360;\n  const s = parseInt(hsl[2], 10) / 100;\n  const l = parseInt(hsl[3], 10) / 100;\n  const a = hsl[4] || 1;\n  function hue2rgb(p, q, t) {\n    if (t < 0) t += 1;\n    if (t > 1) t -= 1;\n    if (t < 1 / 6) return p + (q - p) * 6 * t;\n    if (t < 1 / 2) return q;\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n  }\n  let r, g, b;\n  if (s == 0) {\n    r = g = b = l;\n  } else {\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return `rgba(${r * 255},${g * 255},${b * 255},${a})`;\n}\n\nfunction colorToRgb(val) {\n  if (is.rgb(val)) return rgbToRgba(val);\n  if (is.hex(val)) return hexToRgba(val);\n  if (is.hsl(val)) return hslToRgba(val);\n}\n\n// Units\n\nfunction getUnit(val) {\n  const split = /[+-]?\\d*\\.?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(val);\n  if (split) return split[1];\n}\n\nfunction getTransformUnit(propName) {\n  if (stringContains(propName, 'translate') || propName === 'perspective') return 'px';\n  if (stringContains(propName, 'rotate') || stringContains(propName, 'skew')) return 'deg';\n}\n\n// Values\n\nfunction getFunctionValue(val, animatable) {\n  if (!is.fnc(val)) return val;\n  return val(animatable.target, animatable.id, animatable.total);\n}\n\nfunction getAttribute(el, prop) {\n  return el.getAttribute(prop);\n}\n\nfunction convertPxToUnit(el, value, unit) {\n  const valueUnit = getUnit(value);\n  if (arrayContains([unit, 'deg', 'rad', 'turn'], valueUnit)) return value;\n  const cached = cache.CSS[value + unit];\n  if (!is.und(cached)) return cached;\n  const baseline = 100;\n  const tempEl = null; // document.createElement(el.tagName);\n  const parentEl = null; // (el.parentNode && (el.parentNode !== document)) ? el.parentNode : document.body;\n  parentEl.appendChild(tempEl);\n  tempEl.style.position = 'absolute';\n  tempEl.style.width = baseline + unit;\n  const factor = baseline / tempEl.offsetWidth;\n  parentEl.removeChild(tempEl);\n  const convertedUnit = factor * parseFloat(value);\n  cache.CSS[value + unit] = convertedUnit;\n  return convertedUnit;\n}\n\nfunction getCSSValue(el, prop, unit) {\n  if (prop in el.style) {\n    const uppercasePropName = prop.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n    const value = el.style[prop] || getComputedStyle(el).getPropertyValue(uppercasePropName) || '0';\n    return unit ? convertPxToUnit(el, value, unit) : value;\n  }\n}\n\nfunction getAnimationType(el, prop) {\n  return 'object';\n  if (is.dom(el) && !is.inp(el) && (getAttribute(el, prop) || (is.svg(el) && el[prop]))) return 'attribute';\n  if (is.dom(el) && arrayContains(validTransforms, prop)) return 'transform';\n  if (is.dom(el) && (prop !== 'transform' && getCSSValue(el, prop))) return 'css';\n  if (el[prop] != null) return 'object';\n}\n\nfunction getElementTransforms(el) {\n  if (!is.dom(el)) return;\n  const str = el?.style?.transform || '';\n  const reg = /(\\w+)\\(([^)]*)\\)/g;\n  const transforms = new Map();\n  let m; while (m = reg.exec(str)) transforms.set(m[1], m[2]);\n  return transforms;\n}\n\nfunction getTransformValue(el, propName, animatable, unit) {\n  const defaultVal = stringContains(propName, 'scale') ? 1 : 0 + getTransformUnit(propName);\n  const value = getElementTransforms(el).get(propName) || defaultVal;\n  if (animatable) {\n    animatable.transforms.list.set(propName, value);\n    animatable.transforms['last'] = propName;\n  }\n  return unit ? convertPxToUnit(el, value, unit) : value;\n}\n\nfunction getOriginalTargetValue(target, propName, unit, animatable) {\n  switch (getAnimationType(target, propName)) {\n    case 'transform': return getTransformValue(target, propName, animatable, unit);\n    case 'css': return getCSSValue(target, propName, unit);\n    case 'attribute': return getAttribute(target, propName);\n    default: return target[propName] || 0;\n  }\n}\n\nfunction getRelativeValue(to, from) {\n  const operator = /^(\\*=|\\+=|-=)/.exec(to);\n  if (!operator) return to;\n  const u = getUnit(to) || 0;\n  const x = parseFloat(from);\n  const y = parseFloat(to.replace(operator[0], ''));\n  switch (operator[0][0]) {\n    case '+': return x + y + u;\n    case '-': return x - y + u;\n    case '*': return x * y + u;\n  }\n}\n\nfunction validateValue(val, unit) {\n  if (is.col(val)) return colorToRgb(val);\n  if (/\\s/g.test(val)) return val;\n  const originalUnit = getUnit(val);\n  const unitLess = originalUnit ? val.substr(0, val.length - originalUnit.length) : val;\n  if (unit) return unitLess + unit;\n  return unitLess;\n}\n\n// getTotalLength() equivalent for circle, rect, polyline, polygon and line shapes\n// adapted from https://gist.github.com/SebLambla/3e0550c496c236709744\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n}\n\nfunction getCircleLength(el) {\n  return Math.PI * 2 * getAttribute(el, 'r');\n}\n\nfunction getRectLength(el) {\n  return (getAttribute(el, 'width') * 2) + (getAttribute(el, 'height') * 2);\n}\n\nfunction getLineLength(el) {\n  return getDistance(\n    { x: getAttribute(el, 'x1'), y: getAttribute(el, 'y1') },\n    { x: getAttribute(el, 'x2'), y: getAttribute(el, 'y2') }\n  );\n}\n\nfunction getPolylineLength(el) {\n  const points = el.points;\n  let totalLength = 0;\n  let previousPos;\n  for (let i = 0; i < points.numberOfItems; i++) {\n    const currentPos = points.getItem(i);\n    if (i > 0) totalLength += getDistance(previousPos, currentPos);\n    previousPos = currentPos;\n  }\n  return totalLength;\n}\n\nfunction getPolygonLength(el) {\n  const points = el.points;\n  return getPolylineLength(el) + getDistance(points.getItem(points.numberOfItems - 1), points.getItem(0));\n}\n\n// Path animation\n\nfunction getTotalLength(el) {\n  if (el.getTotalLength) return el.getTotalLength();\n  switch (el.tagName.toLowerCase()) {\n    case 'circle': return getCircleLength(el);\n    case 'rect': return getRectLength(el);\n    case 'line': return getLineLength(el);\n    case 'polyline': return getPolylineLength(el);\n    case 'polygon': return getPolygonLength(el);\n  }\n}\n\nfunction setDashoffset(el) {\n  const pathLength = getTotalLength(el);\n  el.setAttribute('stroke-dasharray', pathLength);\n  return pathLength;\n}\n\n// Motion path\n\nfunction getParentSvgEl(el) {\n  let parentEl = el.parentNode;\n  while (is.svg(parentEl)) {\n    if (!is.svg(parentEl.parentNode)) break;\n    parentEl = parentEl.parentNode;\n  }\n  return parentEl;\n}\n\nfunction getParentSvg(pathEl, svgData) {\n  const svg = svgData || {};\n  const parentSvgEl = svg.el || getParentSvgEl(pathEl);\n  const rect = parentSvgEl.getBoundingClientRect();\n  const viewBoxAttr = getAttribute(parentSvgEl, 'viewBox');\n  const width = rect.width;\n  const height = rect.height;\n  const viewBox = svg.viewBox || (viewBoxAttr ? viewBoxAttr.split(' ') : [0, 0, width, height]);\n  return {\n    el: parentSvgEl,\n    viewBox: viewBox,\n    x: viewBox[0] / 1,\n    y: viewBox[1] / 1,\n    w: width / viewBox[2],\n    h: height / viewBox[3]\n  }\n}\n\nfunction getPath(path, percent) {\n  const pathEl = is.str(path) ? selectString(path)[0] : path;\n  const p = percent || 100;\n  return function (property) {\n    return {\n      property,\n      el: pathEl,\n      svg: getParentSvg(pathEl),\n      totalLength: getTotalLength(pathEl) * (p / 100)\n    }\n  }\n}\n\nfunction getPathProgress(path, progress) {\n  function point(offset = 0) {\n    const l = progress + offset >= 1 ? progress + offset : 0;\n    return path.el.getPointAtLength(l);\n  }\n  const svg = getParentSvg(path.el, path.svg)\n  const p = point();\n  const p0 = point(-1);\n  const p1 = point(+1);\n  switch (path.property) {\n    case 'x': return (p.x - svg.x) * svg.w;\n    case 'y': return (p.y - svg.y) * svg.h;\n    case 'angle': return Math.atan2(p1.y - p0.y, p1.x - p0.x) * 180 / Math.PI;\n  }\n}\n\n// Decompose value\n\nfunction decomposeValue(val, unit) {\n  // const rgx = /-?\\d*\\.?\\d+/g; // handles basic numbers\n  // const rgx = /[+-]?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?/g; // handles exponents notation\n  const rgx = /[+-]?\\d*\\.?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?/g; // handles exponents notation\n  const value = validateValue((is.pth(val) ? val.totalLength : val), unit) + '';\n  return {\n    original: value,\n    numbers: value.match(rgx) ? value.match(rgx).map(Number) : [0],\n    strings: (is.str(val) || unit) ? value.split(rgx) : []\n  }\n}\n\n// Animatables\n\nfunction parseTargets(targets) {\n  const targetsArray = targets ? (flattenArray(is.arr(targets) ? targets.map(toArray) : toArray(targets))) : [];\n  return filterArray(targetsArray, (item, pos, self) => self.indexOf(item) === pos);\n}\n\nfunction getAnimatables(targets) {\n  const parsed = parseTargets(targets);\n  return parsed.map((t, i) => {\n    return { target: t, id: i, total: parsed.length, transforms: { list: getElementTransforms(t) } };\n  });\n}\n\n// Properties\n\nfunction normalizePropertyTweens(prop, tweenSettings) {\n  let settings = cloneObject(tweenSettings);\n  // Override duration if easing is a spring\n  if (/^spring/.test(settings.easing)) settings.duration = spring(settings.easing);\n  if (is.arr(prop)) {\n    const l = prop.length;\n    const isFromTo = (l === 2 && !is.obj(prop[0]));\n    if (!isFromTo) {\n      // Duration divided by the number of tweens\n      if (!is.fnc(tweenSettings.duration)) settings.duration = tweenSettings.duration / l;\n    } else {\n      // Transform [from, to] values shorthand to a valid tween value\n      prop = { value: prop };\n    }\n  }\n  const propArray = is.arr(prop) ? prop : [prop];\n  return propArray.map((v, i) => {\n    const obj = (is.obj(v) && !is.pth(v)) ? v : { value: v };\n    // Default delay value should only be applied to the first tween\n    if (is.und(obj.delay)) obj.delay = !i ? tweenSettings.delay : 0;\n    // Default endDelay value should only be applied to the last tween\n    if (is.und(obj.endDelay)) obj.endDelay = i === propArray.length - 1 ? tweenSettings.endDelay : 0;\n    return obj;\n  }).map(k => mergeObjects(k, settings));\n}\n\n\nfunction flattenKeyframes(keyframes) {\n  const propertyNames = filterArray(flattenArray(keyframes.map(key => Object.keys(key))), p => is.key(p))\n    .reduce((a, b) => { if (a.indexOf(b) < 0) a.push(b); return a; }, []);\n  const properties = {};\n  for (let i = 0; i < propertyNames.length; i++) {\n    const propName = propertyNames[i];\n    properties[propName] = keyframes.map(key => {\n      const newKey = {};\n      for (let p in key) {\n        if (is.key(p)) {\n          if (p == propName) newKey.value = key[p];\n        } else {\n          newKey[p] = key[p];\n        }\n      }\n      return newKey;\n    });\n  }\n  return properties;\n}\n\nfunction getProperties(tweenSettings, params) {\n  const properties = [];\n  const keyframes = params.keyframes;\n  if (keyframes) params = mergeObjects(flattenKeyframes(keyframes), params);;\n  for (let p in params) {\n    if (is.key(p)) {\n      properties.push({\n        name: p,\n        tweens: normalizePropertyTweens(params[p], tweenSettings)\n      });\n    }\n  }\n  return properties;\n}\n\n// Tweens\n\nfunction normalizeTweenValues(tween, animatable) {\n  const t = {};\n  for (let p in tween) {\n    let value = getFunctionValue(tween[p], animatable);\n    if (is.arr(value)) {\n      value = value.map(v => getFunctionValue(v, animatable));\n      if (value.length === 1) value = value[0];\n    }\n    t[p] = value;\n  }\n  t.duration = parseFloat(t.duration);\n  t.delay = parseFloat(t.delay);\n  return t;\n}\n\nfunction normalizeTweens(prop, animatable) {\n  let previousTween;\n  return prop.tweens.map(t => {\n    const tween = normalizeTweenValues(t, animatable);\n    const tweenValue = tween.value;\n    let to = is.arr(tweenValue) ? tweenValue[1] : tweenValue;\n    const toUnit = getUnit(to);\n    const originalValue = getOriginalTargetValue(animatable.target, prop.name, toUnit, animatable);\n    const previousValue = previousTween ? previousTween.to.original : originalValue;\n    const from = is.arr(tweenValue) ? tweenValue[0] : previousValue;\n    const fromUnit = getUnit(from) || getUnit(originalValue);\n    const unit = toUnit || fromUnit;\n    if (is.und(to)) to = previousValue;\n    tween.from = decomposeValue(from, unit);\n    tween.to = decomposeValue(getRelativeValue(to, from), unit);\n    tween.start = previousTween ? previousTween.end : 0;\n    tween.end = tween.start + tween.delay + tween.duration + tween.endDelay;\n    tween.easing = parseEasings(tween.easing, tween.duration);\n    tween.isPath = is.pth(tweenValue);\n    tween.isColor = is.col(tween.from.original);\n    if (tween.isColor) tween.round = 1;\n    previousTween = tween;\n    return tween;\n  });\n}\n\n// Tween progress\n\nconst setProgressValue = {\n  css: (t, p, v) => t.style[p] = v,\n  attribute: (t, p, v) => t.setAttribute(p, v),\n  object: (t, p, v) => t[p] = v,\n  transform: (t, p, v, transforms, manual) => {\n    transforms.list.set(p, v);\n    if (p === transforms.last || manual) {\n      let str = '';\n      transforms.list.forEach((value, prop) => { str += `${prop}(${value}) `; });\n      t.style.transform = str;\n    }\n  }\n}\n\n// Set Value helper\n\nfunction setTargetsValue(targets, properties) {\n  const animatables = getAnimatables(targets);\n  animatables.forEach(animatable => {\n    for (let property in properties) {\n      const value = getFunctionValue(properties[property], animatable);\n      const target = animatable.target;\n      const valueUnit = getUnit(value);\n      const originalValue = getOriginalTargetValue(target, property, valueUnit, animatable);\n      const unit = valueUnit || getUnit(originalValue);\n      const to = getRelativeValue(validateValue(value, unit), originalValue);\n      const animType = getAnimationType(target, property);\n      setProgressValue[animType](target, property, to, animatable.transforms, true);\n    }\n  });\n}\n\n// Animations\n\nfunction createAnimation(animatable, prop) {\n  const animType = getAnimationType(animatable.target, prop.name);\n  if (animType) {\n    const tweens = normalizeTweens(prop, animatable);\n    const lastTween = tweens[tweens.length - 1];\n    return {\n      type: animType,\n      property: prop.name,\n      animatable: animatable,\n      tweens: tweens,\n      duration: lastTween.end,\n      delay: tweens[0].delay,\n      endDelay: lastTween.endDelay\n    }\n  }\n}\n\nfunction getAnimations(animatables, properties) {\n  return filterArray(flattenArray(animatables.map(animatable => {\n    return properties.map(prop => {\n      return createAnimation(animatable, prop);\n    });\n  })), a => !is.und(a));\n}\n\n// Create Instance\n\nfunction getInstanceTimings(animations, tweenSettings) {\n  const animLength = animations.length;\n  const getTlOffset = anim => anim.timelineOffset ? anim.timelineOffset : 0;\n  const timings = {};\n  timings.duration = animLength ? Math.max.apply(Math, animations.map(anim => getTlOffset(anim) + anim.duration)) : tweenSettings.duration;\n  timings.delay = animLength ? Math.min.apply(Math, animations.map(anim => getTlOffset(anim) + anim.delay)) : tweenSettings.delay;\n  timings.endDelay = animLength ? timings.duration - Math.max.apply(Math, animations.map(anim => getTlOffset(anim) + anim.duration - anim.endDelay)) : tweenSettings.endDelay;\n  return timings;\n}\n\nlet instanceID = 0;\n\nfunction createNewInstance(params) {\n  const instanceSettings = replaceObjectProps(defaultInstanceSettings, params);\n  const tweenSettings = replaceObjectProps(defaultTweenSettings, params);\n  const properties = getProperties(tweenSettings, params);\n  const animatables = getAnimatables(params.targets);\n  const animations = getAnimations(animatables, properties);\n  const timings = getInstanceTimings(animations, tweenSettings);\n  const id = instanceID;\n  instanceID++;\n  return mergeObjects(instanceSettings, {\n    id: id,\n    children: [],\n    animatables: animatables,\n    animations: animations,\n    duration: timings.duration,\n    delay: timings.delay,\n    endDelay: timings.endDelay\n  });\n}\n\n// Core\n\nlet activeInstances = [];\nlet pausedInstances = [];\nlet raf;\n\nconst engine = (() => {\n  function play() {\n    raf = requestAnimationFrame(step);\n  }\n  function step(t) {\n    let activeInstancesLength = activeInstances.length;\n    if (activeInstancesLength) {\n      let i = 0;\n      while (i < activeInstancesLength) {\n        const activeInstance = activeInstances[i];\n        if (!activeInstance.paused) {\n          activeInstance.tick(t);\n        } else {\n          const instanceIndex = activeInstances.indexOf(activeInstance);\n          if (instanceIndex > -1) {\n            activeInstances.splice(instanceIndex, 1);\n            activeInstancesLength = activeInstances.length;\n          }\n        }\n        i++;\n      }\n      play();\n    } else {\n      raf = cancelAnimationFrame(raf);\n    }\n  }\n  return play;\n})();\n\nfunction handleVisibilityChange() {\n  if (false) {\n    activeInstances.forEach(ins => ins.pause());\n    pausedInstances = activeInstances.slice(0);\n    anime.running = activeInstances = [];\n  } else {\n    pausedInstances.forEach(ins => ins.play());\n  }\n}\n\nif (typeof document !== 'undefined') {\n  // document.addEventListener('visibilitychange', handleVisibilityChange);\n}\n\n// Public Instance\n\nfunction anime(params = {}) {\n  let startTime = 0, lastTime = 0, now = 0;\n  let children, childrenLength = 0;\n  let resolve = null;\n  \n  function makePromise(instance) {\n    const promise = new Promise(_resolve => resolve = _resolve);\n    instance.finished = promise;\n    return promise;\n  }\n  \n  let instance = createNewInstance(params);\n  let promise = makePromise(instance);\n\n  function toggleInstanceDirection() {\n    const direction = instance.direction;\n    if (direction !== 'alternate') {\n      instance.direction = direction !== 'normal' ? 'normal' : 'reverse';\n    }\n    instance.reversed = !instance.reversed;\n    children.forEach(child => child.reversed = instance.reversed);\n  }\n\n  function adjustTime(time) {\n    return instance.reversed ? instance.duration - time : time;\n  }\n\n  function resetTime() {\n    startTime = 0;\n    lastTime = adjustTime(instance.currentTime) * (1 / anime.speed);\n  }\n\n  function seekChild(time, child) {\n    if (child) child.seek(time - child.timelineOffset);\n  }\n\n  function syncInstanceChildren(time) {\n    if (!instance.reversePlayback) {\n      for (let i = 0; i < childrenLength; i++) seekChild(time, children[i]);\n    } else {\n      for (let i = childrenLength; i--;) seekChild(time, children[i]);\n    }\n  }\n\n  function setAnimationsProgress(insTime) {\n    let i = 0;\n    const animations = instance.animations;\n    const animationsLength = animations.length;\n    while (i < animationsLength) {\n      const anim = animations[i];\n      const animatable = anim.animatable;\n      const tweens = anim.tweens;\n      const tweenLength = tweens.length - 1;\n      let tween = tweens[tweenLength];\n      // Only check for keyframes if there is more than one tween\n      if (tweenLength) tween = filterArray(tweens, t => (insTime < t.end))[0] || tween;\n      const elapsed = minMax(insTime - tween.start - tween.delay, 0, tween.duration) / tween.duration;\n      const eased = isNaN(elapsed) ? 1 : tween.easing(elapsed);\n      const strings = tween.to.strings;\n      const round = tween.round;\n      const numbers = [];\n      const toNumbersLength = tween.to.numbers.length;\n      let progress;\n      for (let n = 0; n < toNumbersLength; n++) {\n        let value;\n        const toNumber = tween.to.numbers[n];\n        const fromNumber = tween.from.numbers[n] || 0;\n        if (!tween.isPath) {\n          value = fromNumber + (eased * (toNumber - fromNumber));\n        } else {\n          value = getPathProgress(tween.value, eased * toNumber);\n        }\n        if (round) {\n          if (!(tween.isColor && n > 2)) {\n            value = Math.round(value * round) / round;\n          }\n        }\n        numbers.push(value);\n      }\n      // Manual Array.reduce for better performances\n      const stringsLength = strings.length;\n      if (!stringsLength) {\n        progress = numbers[0];\n      } else {\n        progress = strings[0];\n        for (let s = 0; s < stringsLength; s++) {\n          const a = strings[s];\n          const b = strings[s + 1];\n          const n = numbers[s];\n          if (!isNaN(n)) {\n            if (!b) {\n              progress += n + ' ';\n            } else {\n              progress += n + b;\n            }\n          }\n        }\n      }\n      setProgressValue[anim.type](animatable.target, anim.property, progress, animatable.transforms);\n      anim.currentValue = progress;\n      i++;\n    }\n  }\n\n  function setCallback(cb) {\n    if (instance[cb] && !instance.passThrough) instance[cb](instance);\n  }\n\n  function countIteration() {\n    if (instance.remaining && instance.remaining !== true) {\n      instance.remaining--;\n    }\n  }\n\n  function setInstanceProgress(engineTime) {\n    const insDuration = instance.duration;\n    const insDelay = instance.delay;\n    const insEndDelay = insDuration - instance.endDelay;\n    const insTime = adjustTime(engineTime);\n    instance.progress = minMax((insTime / insDuration) * 100, 0, 100);\n    instance.reversePlayback = insTime < instance.currentTime;\n    if (children) { syncInstanceChildren(insTime); }\n    if (!instance.began && instance.currentTime > 0) {\n      instance.began = true;\n      setCallback('begin');\n    }\n    if (!instance.loopBegan && instance.currentTime > 0) {\n      instance.loopBegan = true;\n      setCallback('loopBegin');\n    }\n    if (insTime <= insDelay && instance.currentTime !== 0) {\n      setAnimationsProgress(0);\n    }\n    if ((insTime >= insEndDelay && instance.currentTime !== insDuration) || !insDuration) {\n      setAnimationsProgress(insDuration);\n    }\n    if (insTime > insDelay && insTime < insEndDelay) {\n      if (!instance.changeBegan) {\n        instance.changeBegan = true;\n        instance.changeCompleted = false;\n        setCallback('changeBegin');\n      }\n      setCallback('change');\n      setAnimationsProgress(insTime);\n    } else {\n      if (instance.changeBegan) {\n        instance.changeCompleted = true;\n        instance.changeBegan = false;\n        setCallback('changeComplete');\n      }\n    }\n    instance.currentTime = minMax(insTime, 0, insDuration);\n    if (instance.began) setCallback('update');\n    if (engineTime >= insDuration) {\n      lastTime = 0;\n      countIteration();\n      if (!instance.remaining) {\n        instance.paused = true;\n        if (!instance.completed) {\n          instance.completed = true;\n          setCallback('loopComplete');\n          setCallback('complete');\n          if (!instance.passThrough) {\n            resolve();\n            promise = makePromise(instance);\n          }\n        }\n      } else {\n        startTime = now;\n        setCallback('loopComplete');\n        instance.loopBegan = false;\n        if (instance.direction === 'alternate') {\n          toggleInstanceDirection();\n        }\n      }\n    }\n  }\n\n  instance.reset = function () {\n    const direction = instance.direction;\n    instance.passThrough = false;\n    instance.currentTime = 0;\n    instance.progress = 0;\n    instance.paused = true;\n    instance.began = false;\n    instance.loopBegan = false;\n    instance.changeBegan = false;\n    instance.completed = false;\n    instance.changeCompleted = false;\n    instance.reversePlayback = false;\n    instance.reversed = direction === 'reverse';\n    instance.remaining = instance.loop;\n    children = instance.children;\n    childrenLength = children.length;\n    for (let i = childrenLength; i--;) instance.children[i].reset();\n    if (instance.reversed && instance.loop !== true || (direction === 'alternate' && instance.loop === 1)) instance.remaining++;\n    setAnimationsProgress(instance.reversed ? instance.duration : 0);\n  }\n\n  // Set Value helper\n\n  instance.set = function (targets, properties) {\n    setTargetsValue(targets, properties);\n    return instance;\n  }\n\n  instance.tick = function (t) {\n    now = t;\n    if (!startTime) startTime = now;\n    setInstanceProgress((now + (lastTime - startTime)) * anime.speed);\n  }\n\n  instance.seek = function (time) {\n    setInstanceProgress(adjustTime(time));\n  }\n\n  instance.pause = function () {\n    instance.paused = true;\n    resetTime();\n  }\n\n  instance.play = function () {\n    if (!instance.paused) return;\n    if (instance.completed) instance.reset();\n    instance.paused = false;\n    activeInstances.push(instance);\n    resetTime();\n    if (!raf) engine();\n  }\n\n  instance.reverse = function () {\n    toggleInstanceDirection();\n    instance.completed = instance.reversed ? false : true;\n    resetTime();\n  }\n\n  instance.restart = function () {\n    instance.reset();\n    instance.play();\n  }\n\n  instance.reset();\n\n  if (instance.autoplay) instance.play();\n\n  return instance;\n\n}\n\n// Remove targets from animation\n\nfunction removeTargetsFromAnimations(targetsArray, animations) {\n  for (let a = animations.length; a--;) {\n    if (arrayContains(targetsArray, animations[a].animatable.target)) {\n      animations.splice(a, 1);\n    }\n  }\n}\n\nfunction removeTargets(targets) {\n  const targetsArray = parseTargets(targets);\n  for (let i = activeInstances.length; i--;) {\n    const instance = activeInstances[i];\n    const animations = instance.animations;\n    const children = instance.children;\n    removeTargetsFromAnimations(targetsArray, animations);\n    for (let c = children.length; c--;) {\n      const child = children[c];\n      const childAnimations = child.animations;\n      removeTargetsFromAnimations(targetsArray, childAnimations);\n      if (!childAnimations.length && !child.children.length) children.splice(c, 1);\n    }\n    if (!animations.length && !children.length) instance.pause();\n  }\n}\n\n// Stagger helpers\n\nfunction stagger(val, params = {}) {\n  const direction = params.direction || 'normal';\n  const easing = params.easing ? parseEasings(params.easing) : null;\n  const grid = params.grid;\n  const axis = params.axis;\n  let fromIndex = params.from || 0;\n  const fromFirst = fromIndex === 'first';\n  const fromCenter = fromIndex === 'center';\n  const fromLast = fromIndex === 'last';\n  const isRange = is.arr(val);\n  const val1 = isRange ? parseFloat(val[0]) : parseFloat(val);\n  const val2 = isRange ? parseFloat(val[1]) : 0;\n  const unit = getUnit(isRange ? val[1] : val) || 0;\n  const start = params.start || 0 + (isRange ? val1 : 0);\n  let values = [];\n  let maxValue = 0;\n  return (el, i, t) => {\n    if (fromFirst) fromIndex = 0;\n    if (fromCenter) fromIndex = (t - 1) / 2;\n    if (fromLast) fromIndex = t - 1;\n    if (!values.length) {\n      for (let index = 0; index < t; index++) {\n        if (!grid) {\n          values.push(Math.abs(fromIndex - index));\n        } else {\n          const fromX = !fromCenter ? fromIndex % grid[0] : (grid[0] - 1) / 2;\n          const fromY = !fromCenter ? Math.floor(fromIndex / grid[0]) : (grid[1] - 1) / 2;\n          const toX = index % grid[0];\n          const toY = Math.floor(index / grid[0]);\n          const distanceX = fromX - toX;\n          const distanceY = fromY - toY;\n          let value = Math.sqrt(distanceX * distanceX + distanceY * distanceY);\n          if (axis === 'x') value = -distanceX;\n          if (axis === 'y') value = -distanceY;\n          values.push(value);\n        }\n        maxValue = Math.max(...values);\n      }\n      if (easing) values = values.map(val => easing(val / maxValue) * maxValue);\n      if (direction === 'reverse') values = values.map(val => axis ? (val < 0) ? val * -1 : -val : Math.abs(maxValue - val));\n    }\n    const spacing = isRange ? (val2 - val1) / maxValue : val1;\n    return start + (spacing * (Math.round(values[i] * 100) / 100)) + unit;\n  }\n}\n\n// Timeline\n\nfunction timeline(params = {}) {\n  let tl = anime(params);\n  tl.duration = 0;\n  tl.add = function (instanceParams, timelineOffset) {\n    const tlIndex = activeInstances.indexOf(tl);\n    const children = tl.children;\n    if (tlIndex > -1) activeInstances.splice(tlIndex, 1);\n    function passThrough(ins) { ins.passThrough = true; };\n    for (let i = 0; i < children.length; i++) passThrough(children[i]);\n    let insParams = mergeObjects(instanceParams, replaceObjectProps(defaultTweenSettings, params));\n    insParams.targets = insParams.targets || params.targets;\n    const tlDuration = tl.duration;\n    insParams.autoplay = false;\n    insParams.direction = tl.direction;\n    insParams.timelineOffset = is.und(timelineOffset) ? tlDuration : getRelativeValue(timelineOffset, tlDuration);\n    passThrough(tl);\n    tl.seek(insParams.timelineOffset);\n    const ins = anime(insParams);\n    passThrough(ins);\n    const totalDuration = ins.duration + insParams.timelineOffset;\n    children.push(ins);\n    const timings = getInstanceTimings(children, params);\n    tl.delay = timings.delay;\n    tl.endDelay = timings.endDelay;\n    tl.duration = timings.duration;\n    tl.seek(0);\n    tl.reset();\n    if (tl.autoplay) tl.play();\n    return tl;\n  }\n  return tl;\n}\n\nanime.version = '3.2.0';\nanime.speed = 1;\nanime.running = activeInstances;\nanime.remove = removeTargets;\nanime.get = getOriginalTargetValue;\nanime.set = setTargetsValue;\nanime.convertPx = convertPxToUnit;\nanime.path = getPath;\nanime.setDashoffset = setDashoffset;\nanime.stagger = stagger;\nanime.timeline = timeline;\nanime.easing = parseEasings;\nanime.penner = penner;\nanime.random = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;\n\nexport default anime;","import React, { useState, useEffect, useRef } from 'react'\nimport { Html, useAspect } from '@react-three/drei'\nimport { Dimensions } from 'react-native'\nimport { useThree } from '@react-three/fiber'\nimport { useEvents } from '../../systems/World/hooks'\nimport { GAME_EVENTS } from '../../systems/World/Events'\nimport anime from '../../helpers/anime';\n\nconst CountDown = () => {\n  const [count, setCount] = useState()\n  const [start, setStart] = useState()\n  const gameReadyTrigger = useEvents(GAME_EVENTS.READY_ON)\n  const systemOnlineTrigger = useEvents(GAME_EVENTS.SYSTEM_ONLINE)\n  const { camera } = useThree()\n  const tId = useRef()\n  useEffect(() => {\n    if (count === 0) {\n      gameReadyTrigger()\n    } else {\n      if (count !== undefined) {\n        tId.current = setTimeout(() => {\n          setCount(count - 1)\n        }, 750)\n      }\n    }\n    () => {\n      clearTimeout(tId.current)\n    }\n  }, [count])\n  useEffect(() => {\n    if (!start) return\n    const destination = { x: -5, y: 11, z: 20 } //{...camera.position}\n    camera.position.x = -3\n    camera.position.y = -15\n    camera.position.z = 10\n    camera.lookAt(0, 0, 3)\n    const targetObj = { ...camera.position }\n    anime({\n      easing: Math.random() > 0.5 ? 'easeInOutExpo' : 'easeInOutBack',\n      duration: 6000,\n      x: destination.x,\n      y: destination.y,\n      z: destination.z,\n      targets: targetObj,\n      update: function () {\n        camera.position.x = targetObj.x\n        camera.position.y = targetObj.y\n        camera.position.z = targetObj.z\n        camera.lookAt(0, 0, 3)\n      },\n      complete: function () {\n        setCount(3)\n      }\n    })\n  }, [start])\n  useEffect(() => {\n    setTimeout(() => {\n      systemOnlineTrigger()\n      setStart(true)\n    }, 2000)\n  }, [camera])\n  const width = Dimensions.get(\"window\").width > 900 ? 900 : Dimensions.get(\"window\").width\n  const height = Dimensions.get(\"window\").height > 400 ? 400 : Dimensions.get(\"window\").height\n  \n  const scale = useAspect(\n    \"cover\",\n    width,\n    height,\n    1\n  )\n  return (\n    count > 0 &&\n    <Html scaleFactor={scale}\n      calculatePosition={() => [0, 0, 0]}\n      style={{\n          // backgroundColor: '#0f0a',\n          minWidth: width,\n          minHeight: height\n        }}\n    // position={[-scale.width, 0, -scale.height]}\n    >\n      { count !== 0 &&\n        <div\n          className=\"content\"\n          style={{\n            // border: '1px solid red',\n            // backgroundColor: '#f00a',\n            display: 'flex',\n            color: 'white',\n            fontFamily: 'Arial',\n            fontWeight: 'bold',\n            flexBasis: '100%',\n            width: '100%',\n            height: '100%',\n            minWidth: '100%',\n            minHeight: '100%',\n            boxSizing: 'border-box',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}>\n          <span style={{ fontSize: 180 }}>{count}</span>\n        </div>\n      }\n    </Html>\n  )\n}\nexport default CountDown","import { useState, useEffect } from 'react'\n// Hook\nfunction useKeyPress(targetKey) {\n  // State for keeping track of whether key is pressed\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  // If pressed key is our target key then set to true\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      setKeyPressed(true);\n    }\n  }\n\n  // If released key is our target key then set to false\n  const upHandler = ({ key }) => {\n    if (key === targetKey) {\n      setKeyPressed(false);\n    }\n  };\n\n  // Add event listeners\n  useEffect(() => {\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n    // Remove event listeners on cleanup\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n  }, []); // Empty array ensures that effect is only run on mount and unmount\n\n  return keyPressed;\n}\n\nexport default useKeyPress","import React, { useEffect } from 'react'\nimport { View, Dimensions } from 'react-native'\nimport useKeyPress from '../../hooks/useKeyPress'\nimport mainButton from '../../../assets/arena/throttle_button.png'\n\n\nconst { height, width } = Dimensions.get('screen');\nconst KEY_THROTTLE_BY_PLAYER_INDEX = {\n  0: 'z',\n  1: 'm',\n}\nconst SCREEN_POS_BY_PLAYER_INDEX = {\n  // player 1 lower right\n  0: {\n    posX: width - 100,\n    posY: height - 100,\n    width,\n    height,\n  },\n  // player 2 lower left\n  1: {\n    posX: 0,\n    posY: height - 100,\n    width: 100,\n    height,\n    color: '#00f',\n  }\n}\nconst COLORS_BY_PLAYER_INDEX = {\n  0: {\n    player: '#AFC97E',\n    controller: '#AFC97E',\n  },\n  1: {\n    player: '#306BAC',\n    controller: '#306BAC',\n  }\n}\nconst usePlayers = (refs = []) => {\n  const playersConfig = refs.map((p, idx) => {\n    return (\n      {\n        name: `player${idx + 1}`,\n        ...SCREEN_POS_BY_PLAYER_INDEX[idx],\n        keyboardThrottle: KEY_THROTTLE_BY_PLAYER_INDEX[idx],\n        isThrottling: false,\n        hit: false,\n        controller: p,\n        color: COLORS_BY_PLAYER_INDEX[idx],\n      }\n    )\n  })\n  \n  return playersConfig\n}\n\nconst useHitArea = (hitAreaPlayers = []) => {\n  const checkTouchOnPlayerAreas = evt => {\n    hitAreaPlayers.forEach(ha => ha.hit = false)\n    if(evt.nativeEvent.touches && evt.nativeEvent.touches[0] || evt.nativeEvent.type === 'mousedown') {\n      hitAreaPlayers[1].hit = true\n    }\n    // evt.nativeEvent.touches.forEach(t => {\n    //   hitAreaPlayers.forEach(ha => {\n    //     if (\n    //       (t.pageX > ha.posX &&\n    //       t.pageY > ha.posY &&\n    //       t.pageX < ha.posX + ha.width &&\n    //       t.pageY < ha.posY + ha.height)\n    //       || ha.isThrottling\n    //     ) {\n    //       // const touchTime = global.nativePerformanceNow()\n    //       const touchTime = window.performance.now()\n    //       const diff = touchTime - ha.lastTouchTime;\n    //       if (diff < 150) {\n    //         ha.doubleTap = true\n    //       } else {\n    //         ha.doubleTap = false\n    //       }\n    //       ha.hit = true\n    //       ha.lastTouchTime = touchTime;\n    //     }\n    //   })\n    // })\n\n    hitAreaPlayers.forEach(ha => {\n      if (ha.hit) {\n      }\n      ha.controller.dispatch(`controller_${ha.hit ? 'on' : 'off'}`)\n      if (ha.doubleTap) {\n        ha.doubleTap = false\n        // ha.controller.dispatch('controller_doubleTap')\n      }\n    })\n  }\n  return {\n    handleTouchStart: checkTouchOnPlayerAreas,\n    handleTouchEnd: checkTouchOnPlayerAreas,\n  }\n}\n\nconst Controllers = ({ forPlayers = [], noUI}) => {\n  // gets players config\n  const players = usePlayers(forPlayers)\n\n  useEffect(() => {\n    // setTimeout(() => {\n    //   players.find(p => p.name === 'player1').controller.dispatch('controller_restart')\n    // }, 5000);\n    // external API\n    window.SS_controller_p2_throttle = state => {\n      players[1].isThrottling = state\n      handleTouchStart({ nativeEvent: { touches: [{}] }})\n    }\n    // window.SS_controller_p1_throttle = state => {\n    //   players[0].isThrottling = state\n    //   handleTouchStart({ nativeEvent: { touches: [{}] }})\n    // }\n  }, [])\n  \n  // makes player configs to handle events\n  const { handleTouchStart, handleTouchEnd } = useHitArea(players)\n  // (players[0].keyboardThrottle)\n  const P1ThrottleKeyPressed = useKeyPress(players[0].keyboardThrottle)\n  useEffect(() => {\n    players[0].isThrottling = P1ThrottleKeyPressed\n    handleTouchStart({ nativeEvent: { touches: [{}] }})\n  }, [P1ThrottleKeyPressed])\n\n  const P2ThrottleKeyPressed = useKeyPress(players[1].keyboardThrottle)\n  useEffect(() => {\n    players[1].isThrottling = P2ThrottleKeyPressed\n    handleTouchStart({ nativeEvent: { touches: [{}] } })\n  }, [P2ThrottleKeyPressed])\n\n  useEffect(() => {\n    window.oncontextmenu = function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      return false;\n    };\n  }, []);\n  return (\n    <React.Fragment>\n      {\n        players[0] && !noUI ? \n        <View\n        onTouchStart={handleTouchStart}\n        onTouchEnd={handleTouchEnd}\n        onMouseDown={handleTouchStart}\n        onMouseUp={handleTouchEnd}\n        style={{ position: 'absolute', zIndex: 100, width: 100, height: 100, bottom: 30, right: 50,\n        // backgroundColor: `${players[0].color.controller}aa`\n      }}\n      >\n          <img src={mainButton}\n          style={{ position: 'relative', width: 100, height: 100}} />\n        </View>:null\n      }\n      {/* {\n        players[1] && !noUI?\n        <View\n          onTouchStart={handleTouchStart}\n          onTouchEnd={handleTouchEnd}\n            style={{ position: 'absolute', width: 100, height: 100, bottom: 0, left: 0, backgroundColor: `${players[1].color.controller}aa`\n           }}\n        >\n          <img src={mainButton} />\n        </View>:null\n      } */}\n    </React.Fragment>\n  )\n}\n\nexport default Controllers","import React, { useRef, forwardRef, useState, useEffect } from 'react'\nimport Color from 'color'\nimport { useLoader, useFrame } from '@react-three/fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\nimport { Text } from '@react-three/drei'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/arena/towerSquare_bottomB.obj'\nimport modelMtl from '../../../assets/arena/towerSquare_bottomB.mtl'\n\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const [materialOffsetDirection, setMaterialOffsetDirection] = useState(1)\n  const { texture, tint = \"#fff\", name = '', ...moreProps } = props\n\n  // const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  // threeTone.minFilter = THREE.NearestFilter;\n  // threeTone.magFilter = THREE.NearestFilter;\n  \n  // const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  // const materialChassis = colorPalette[0] ? new THREE.MeshLambertMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialDeco = colorPalette[1] ? new THREE.MeshLambertMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialCore = colorPalette[2] ? new THREE.MeshLambertMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  // const materialDome = colorPalette[3] ? new THREE.MeshLambertMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialPurple =  new THREE.MeshLambertMaterial({ color: tint })\n  const materialStone = new THREE.MeshLambertMaterial({ color: Color(tint).darken(0.5).toString() })\n  const materialStoneDark = new THREE.MeshLambertMaterial({ color: Color(tint).darken(0.8).toString() })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialPurple// purple\n    obj.children[0].material[1] = materialStone// stone\n    obj.children[0].material[2] = materialStoneDark// stoneDark\n    obj.children[0].receiveShadow = true\n    setGeometry(obj)\n  }\n  useEffect(loadObject,[])\n\n  return (\n    <>\n      <group\n        position={[0, -1.9, 7.9]}\n      >\n        <Text\n          // font={require('../../../assets/fonts/Sandoval.ttf')}\n          fontSize={1}\n          anchorX=\"center\" // default\n          anchorY=\"middle\" // default\n          material={new THREE.MeshBasicMaterial({color: tint, opacity: 0.5, transparent: true })}\n        >\n          {name.toUpperCase()}\n        </Text>\n      </group>\n      <group\n        ref={fwdRef}\n        {...moreProps}\n      >\n        {geometry &&\n          <primitive object={geometry} />\n        }\n      </group>\n    </>\n  )\n})","import React, { createContext } from 'react'\nconst context = createContext({})\n\nexport default context","import React, { useLayoutEffect, useContext, useRef, useMemo, useEffect, useState } from 'react'\nimport { THREE } from 'expo-three'\nimport { useFrame } from '@react-three/fiber'\nimport Box2D from 'box2dweb'\nimport context from './context'\n\nconst b2FixtureDef = Box2D.Dynamics.b2FixtureDef;\nconst b2BodyDef = Box2D.Dynamics.b2BodyDef;\nconst b2Body = Box2D.Dynamics.b2Body;\nconst b2Vec2 = Box2D.Common.Math.b2Vec2;\n\nconst shapes = {\n  circle: Box2D.Collision.Shapes.b2CircleShape,\n  box: Box2D.Collision.Shapes.b2PolygonShape,\n}\n\nexport function useApi () {\n  const { world, refs, destroyQueue } = useContext(context)\n  function impulse(uuid, state) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    const { freeze } = body.GetUserData()\n    if (!freeze) {\n      body.SetUserData({ ...body.GetUserData(), impulse: state, rotate: !state })\n    }\n  }\n  function rotate(uuid, state) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    const { freeze } = body.GetUserData()\n    if (!freeze) {\n      body.SetUserData({ ...body.GetUserData(), rotate: state })\n    }\n  }\n  function revertSpin(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    const userData = body.GetUserData()\n    body.SetUserData({\n      ...userData,\n      spinFactor: userData.spinFactor * -1,\n    })\n  }\n  function overchargePower(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), coil: true })\n  }\n  function dischargePower(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), coil: false })\n  }\n  function overchargeFreezer(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), freezer: true })\n  }\n  function dischargeFreeze(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), freezer: false })\n  }\n  function grow(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body, object} = refs[uuid]\n    // const fixture = body.GetFixtureList()\n\n    // grow Box2D radius\n    body.GetFixtureList().m_shape.m_radius = body.GetFixtureList().m_shape.m_radius * 1.7\n    body.SetUserData({ ...body.GetUserData(), hulk: 1 })\n    // // grow ThreeJS scale\n    // object.scale.set(1.5, 1.5, 1.5)\n  }\n  function freeze(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const body = refs[uuid].body\n    body.SetUserData({ ...body.GetUserData(), rotate: false, freeze: true, impulse: false })\n    object.userData.freeze = true\n  }\n  function unfreeze(uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body, object} = refs[uuid]\n    body.SetUserData({ ...body.GetUserData(), rotate: true, freeze: false })\n    object.userData.freeze = false\n  }\n  function hyperJump(uuid, { x = 0, y = 0 }) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    body.SetTransform({ position: {x, y}, GetAngle: () => body.GetAngle() })\n  }\n  function outOfThisWorld (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {body} = refs[uuid]\n    for (var f = body.GetFixtureList(); f; f = f.GetNext()) {\n      // disable collision\n      f.SetSensor(true)\n    }\n  }\n  function destroy (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    destroyQueue.push(refs[uuid].body)\n  }\n  function restart (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return\n    const {object} = refs[uuid]\n    const originPosition = object.userData.origin\n    console.log(originPosition)\n    const [x, y, z] = originPosition || [0,0,0];\n    const origin = { x, y: z };\n    const body = refs[uuid].body\n    // remove forces\n    body.SetLinearVelocity(new b2Vec2(0, 0))\n    // restart angle and position\n    body.SetTransform({ position: { ...origin }, GetAngle: () => body.GetAngle() })\n    for (var f = body.GetFixtureList(); f; f = f.GetNext()) {\n      // re-enable collision\n      f.SetSensor(false)\n    }\n  }\n  const createCharacter = (object, type, world) => {\n    const fixtureDef = new b2FixtureDef()\n    fixtureDef.shape = new shapes[type]()\n    const bodyDef = new b2BodyDef();\n    bodyDef.type = object.userData.static ? b2Body.b2_staticBody : b2Body.b2_dynamicBody;\n    // fixtureDef.density = 1\n    if (type === 'circle') {\n      // if (!object.userData.radius) {\n      //   object.children[1].geometry.computeBoundingBox()\n      // }\n      fixtureDef.shape.SetRadius(object.userData.radius || 0.5)\n    }\n    if (type === 'box') {\n      fixtureDef.shape.SetAsBox(object.userData.hx || 0.5, object.userData.hy || 0.5)\n    }\n\n    if (!object.userData.static) {\n      fixtureDef.density = object.userData.density || 1.0;\n      fixtureDef.friction = object.userData.friction  || 1;\n      fixtureDef.restitution = object.userData.restitution || 1;\n      fixtureDef.isSensor = object.userData.pickable || false;\n\n      bodyDef.linearDamping = 1\n      bodyDef.bullet = true\n    }\n    \n\n    bodyDef.position.Set(object.position.x, object.position.z)\n    bodyDef.angle = object.userData.angle || 0\n\n    const body = world.CreateBody(bodyDef)\n    body.CreateFixture(fixtureDef);\n    body.SetUserData({\n      impulse: false,\n      rotate: true,\n      spinFactor: 1,\n      ...object.userData,\n      uuid: object.uuid,\n    });\n    // bodyDef.SetAngle(object.angle || 0)\n\n    // refs[object.uuid] = {\n    //   object,\n    //   body,\n    // }\n    return body\n  }\n\n  function getPhysicsUserData (uuid) {\n    if (!refs.hasOwnProperty(uuid)) return {}\n    return refs[uuid].body.GetUserData()\n  }\n  return {\n    impulse,\n    rotate,\n    freeze,\n    unfreeze,\n    destroy,\n    restart,\n    createCharacter,\n    grow,\n    revertSpin,\n    overchargePower,\n    dischargePower,\n    overchargeFreezer,\n    dischargeFreeze,\n    hyperJump,\n    outOfThisWorld,\n    getPhysicsUserData,\n  }\n}\n\nfunction useBody(\n  type,\n  config,\n  fwdRef\n) {\n  const localRef = useRef(null)\n  const ref = fwdRef ? fwdRef : localRef\n  const api = useApi()\n  const { world, refs } = useContext(context)\n  // const [body, setBody] = useState()\n  // const [object, setObject] = useState()\n  // const [impulse, setImpulse] = useState(true)\n\n  useEffect(() => {\n    if (!ref.current || !world) {\n      return\n      // When the reference isn't used we create a stub\n      // The body doesn't have a visual representation but can still be constrained\n      // ref.current = new THREE.Object3D()\n    }\n    \n    const object = ref.current\n    if (!refs.hasOwnProperty(object.uuid)) {\n      const body = api.createCharacter(object, type, world);\n      refs[object.uuid] = { object, body }\n    }\n  }, [world])\n  \n  return [ref, api]\n}\n\nexport function useCircle(config, fwdRef) {\n  return useBody('circle', config, fwdRef)\n}\nexport function useBox(config, fwdRef) {\n  return useBody('box', config, fwdRef)\n}","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_flat/enemy_ufoPurple.obj'\nimport modelMtl from '../../../assets/enemy_flat/enemy_ufoPurple.mtl'\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[2] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialChassis// snowRoad\n    obj.children[0].material[1] = materialDeco// purple\n    obj.children[0].material[2] = materialCore// stoneDark\n    obj.children[0].material[3] = materialDome// glass\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_bubble/enemy_ufoGreen.obj'\nimport modelMtl from '../../../assets/enemy_bubble/enemy_ufoGreen.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialChassis// snowRoad\n    obj.children[0].material[1] = materialDome// glass\n    obj.children[0].material[2] = materialDeco// foliage\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_pill/enemy_ufoRed.obj'\nimport modelMtl from '../../../assets/enemy_pill/enemy_ufoRed.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialDome// glass\n    obj.children[0].material[1] = materialChassis// snowRoadDark\n    obj.children[0].material[2] = materialDeco// stoneDark\n    obj.children[0].material[3] = materialDeco// red\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","import React, { useRef, forwardRef, useState, useEffect, useMemo } from 'react'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/enemy_burger/enemy_ufoYellow.obj'\nimport modelMtl from '../../../assets/enemy_burger/enemy_ufoYellow.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[1] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[3] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialDome// glass\n    obj.children[0].material[1] = materialChassis// snowRoadDark\n    obj.children[0].material[2] = materialDeco// stoneDark\n    obj.children[0].material[3] = materialDeco// red\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  return useMemo(() =>\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n    </group>\n  , [geometry])\n})","export const PALETTES = {\n  // PAC-MAN\n  1: [\n    '#999106',\n    '#635e09',\n    '#000000',\n    '#e4e4ef'\n  ],\n  // INKY\n  2: [\n    '#034f82',\n    '#5605a8',\n    '#878787',\n    '#e4e4ef'\n  ],\n  // PINKY\n  3: [\n    '#ed34ac',\n    '#5605a8',\n    '#878787',\n    '#e4e4ef'\n  ],\n  // BLINKY\n  4: [\n    '#bf0a0a',\n    '#5605a8',\n    '#878787',\n    '#e4e4ef'\n  ]\n}","import React, { useRef, useState, Suspense, forwardRef, useEffect } from 'react'\nimport { THREE } from 'expo-three'\nimport { useFrame } from '@react-three/fiber'\nimport { Html, useAspect } from '@react-three/drei'\nimport { useCircle, useApi } from '../../systems/Physics/hooks'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\nimport Ufo from '../UfoModels/UfoModel1'\nimport Ufo2 from '../UfoModels/UfoModel2'\nimport Ufo3 from '../UfoModels/UfoModel3'\nimport Ufo4 from '../UfoModels/UfoModel4'\nimport anime from '../../helpers/anime'\nimport emoteSwirl from '../../../assets/emotes/emote_swirl.png'\nimport { PALETTES } from '../../constants/gameOptions'\n\n/* PINK AND BLUE\n'#022f4d',\n'#660f1e',\n'#4a4848',\n'#e4e4ef'\n*/\n\nfunction SmokeInstances({ originMeshRef, color, seed = 0.3 }) {\n  const [sphereRefs] = useState(() => [])\n  const range = center => Math.random() * ((center + 0.4) - (center - 0.3)) + (center - 0.3)\n  const rangeMinMax = (min, max) => Math.random() * (max - min) + min\n  // const range = center => center - 0.35\n  const initialPositions = [\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 1), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 2), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 3), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 4), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 5), range(originMeshRef.current.position.z)],\n    [range(originMeshRef.current.position.x - 0.2), originMeshRef.current.position.y - (seed * 6), range(originMeshRef.current.position.z)],\n  ]\n  const INCREMENT = 0.02\n  // smaller spheres movement\n  useFrame(() => {\n    // animate each sphere in the array\n    sphereRefs.forEach((el, idx) => {\n      el.position.y += INCREMENT\n      \n      if (el.position.y > originMeshRef.current.position.y + INCREMENT && el.position.y < originMeshRef.current.position.y + INCREMENT * 2) {\n        el.material.opacity = 1\n        // updates position\n        el.position.x = range(originMeshRef.current.position.x - 0.2)\n        el.position.z = range(originMeshRef.current.position.z - 0.2)\n      }\n\n      el.material.opacity -= 0.02\n      if (el.position.y > 1.5) {\n        el.material.opacity = 0\n        el.position.y = originMeshRef.current.position.y - 0.3 * idx\n        el.position.x = originMeshRef.current.position.x\n        el.position.z = originMeshRef.current.position.z\n      }\n    })\n  })\n  return (\n    <>\n      {initialPositions.map((pos, i) => (\n        <mesh\n          position={[pos[0], pos[1], pos[2]]}\n          key={i}\n          ref={(ref) => (sphereRefs[i] = ref)}\n        >\n          {/* <boxBufferGeometry args={[0.2, 0.2, 0.2]}/> */}\n          <sphereBufferGeometry args={[rangeMinMax(0.05, 0.2)]} />\n          <meshBasicMaterial color={color} opacity={0} transparent />\n        </mesh>\n      ))}\n    </>\n  )\n}\nconst Model = forwardRef((props, ref) => {\n  const [isFreezed, setFreezed] = useState()\n  const [emote, setEmote] = useState()\n  const [powerMaterial] = useState(new THREE.MeshNormalMaterial({ transparent: true, opacity: 0, wireframe: false, side: THREE.BackSide }))\n  const emoteTimerId = useRef()\n  const powerRef = useRef()\n  const ufoRef = useRef()\n  const orignalColors = useRef({})\n  const api = useApi()\n  let baseRef = ref\n  useEvents(CHARACTER_EVENTS.GETS_FREEZER, uuid => {\n    if (uuid === baseRef.current.uuid && !isFreezed) {\n      setFreezed(true)\n    }\n  })\n  useEvents(CHARACTER_EVENTS.UNFREEZE, (uuid) => {\n    if (uuid === baseRef.current.uuid && isFreezed) {\n      api.unfreeze(baseRef.current.uuid)\n      setFreezed(false)\n    }\n  })\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_GROW, uuid => {\n    if (uuid === baseRef.current.uuid) {\n      const targetObj = { scale: 1 }\n      anime({\n        easing: 'linear',\n        duration: 250,\n        scale: 1.5,\n        targets: targetObj,\n        update: function () {\n          baseRef.current.scale.set(targetObj.scale, targetObj.scale, targetObj.scale)\n        }\n      })\n    }\n  })\n  const growOverchargeSphere = uuid => {\n    if (uuid === baseRef.current.uuid) {\n      powerRef.current.visible = true\n      anime({\n        easing: 'linear',\n        duration: 250,\n        opacity: 0.5,\n        targets: powerMaterial,\n      })\n    }\n  }\n  const shrinkOverchargeSphere = uuid => {\n    if (uuid === baseRef.current.uuid) {\n      anime({\n        easing: 'linear',\n        duration: 250,\n        opacity: 0,\n        targets: powerMaterial,\n        complete: function () {\n          powerRef.current.visible = false\n        }\n      })\n    }\n  }\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_COIL, growOverchargeSphere)\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_FREEZER, growOverchargeSphere)\n  useEvents(CHARACTER_EVENTS.DISCHARGE, shrinkOverchargeSphere)\n  \n  if (!props.userData.detached) {\n    [baseRef] = useCircle({}, ref)\n  } else {\n  }\n  useEvents(CHARACTER_EVENTS.EXTERNAL_SPIN_CHANGE, uuid => {\n    if (uuid === baseRef.current.uuid) {\n      setEmote(emoteSwirl)\n    }\n  })\n\n  useEffect(() => {\n    if (emote) {\n      clearTimeout(emoteTimerId.current)\n      emoteTimerId.current = setTimeout(() => {\n        setEmote()\n      }, 1000)\n    }\n  }, [emote])\n\n  // const v1 = new THREE.Vector3(-0.25, 0, 0)\n  // const v2 = new THREE.Vector3(0, -0.25, 0)\n  // const v3 = new THREE.Vector3(0, 0.25, 0)\n  \n  const shape = new THREE.Shape();\n  const x = 0;\n  const y = 0;\n  shape.moveTo(x - 0.2, y - 0.2);\n  shape.lineTo(x + 0.2, y - 0.2);\n  shape.lineTo(x, y + 0.2);\n  const indicatorGeometry = new THREE.ShapeGeometry(shape);\n\n  // const radius =  0.25;  \n  // const segments =  1;  \n  // const indicatorGeometry = new THREE.CircleGeometry(radius, segments);\n\n  // indicatorGeometry.vertices.push(v1)\n  // indicatorGeometry.vertices.push(v2)\n  // indicatorGeometry.vertices.push(v3)\n\n  // indicatorGeometry.faces.push(new THREE.Face3(0, 1, 2))\n  // indicatorGeometry.computeFaceNormals()\n\n  \n  useEffect(() => {\n    if (isFreezed === true) {\n      const offColorMaterial = new THREE.MeshBasicMaterial({ color: '#666666' })\n      const materials = ufoRef.current\n      // group\n      .children[0]\n      // mesh\n      .children[0]\n      .material\n      materials.forEach((material, i) => {\n        orignalColors.current[i] = material.color\n        material.color = new THREE.Color(i % 2 === 0 ? 0x666666 : 0x999999)\n      })\n      setTimeout(() => {\n        const targetObj = { x: -0.15 }\n        let times = 0\n        const animation = anime({\n          easing: 'linear',\n          duration: 100,\n          x: 0.15,\n          targets: targetObj,\n          loop: true,\n          direction: 'alternate',\n          update: function () {\n            times++\n            ufoRef.current.position.x = targetObj.x\n            if (times >= 50) {\n              ufoRef.current.position.x = 0\n              animation.pause()\n            }\n          },\n        })\n      }, 4000);\n    }\n\n    if (isFreezed === false) {\n      const materials = ufoRef.current\n      // group\n      .children[0]\n      // mesh\n      .children[0]\n      .material\n      materials.forEach((material, i) => {\n        material.color.r = orignalColors.current[i].r\n        material.color.g = orignalColors.current[i].g\n        material.color.b = orignalColors.current[i].b\n      })\n    }\n  }, [isFreezed])\n\n  let UfoModel\n  let indicatorOffset = [0, 0, 0]\n  let indicatorColor\n  switch (props.model) {\n    case 1:\n    default:\n      UfoModel = Ufo\n      // indicatorOffset = [0.5, 0.25, 0]\n      indicatorOffset = [0.25, 0.25, 0]\n      indicatorColor = 'black'\n      break\n    case 2:\n      UfoModel = Ufo2\n      indicatorOffset = [0.35, 0.35, 0]\n      indicatorColor = 'red'\n      break\n    case 3:\n      UfoModel = Ufo3\n      indicatorOffset = [0.25, 0.35, 0]\n      indicatorColor = 'blue'\n      break\n    case 4:\n      UfoModel = Ufo4\n      indicatorOffset = [0.25, 0.35, 0]\n      indicatorColor = 'white'\n      break\n  }\n\n  const indicatorMaterial = new THREE.MeshBasicMaterial({ color: indicatorColor })\n  return (\n    <Suspense fallback={null}>\n      <>\n        {baseRef.current && !isFreezed && (\n          <SmokeInstances\n            originMeshRef={baseRef}\n            color={PALETTES[props.model || 1][0]}\n            seed={Math.random() * (0.3 - 0.01) + 0.01} />\n        )}\n        <group\n          ref={baseRef}\n          {...props}\n          dispose={null}\n        >\n          <Html>\n            {\n              emote && (\n                <div style={{ backgroundColor: 'transparent', marginTop: -38*1.5, marginLeft: -32/2}}>\n                  <img src={emote} />\n                </div>\n              )\n            }\n          </Html>\n          <mesh\n            ref={powerRef}\n            visible={false}\n            material={powerMaterial}\n          >\n            <sphereBufferGeometry args={[0.7, 10, 10]} />\n          </mesh>\n          {/* <mesh material={materials.snowRoad} geometry={nodes['Mesh enemy_ufoPurple_0'].geometry} />\n          <mesh material={materials.purple} geometry={nodes['Mesh enemy_ufoPurple_1'].geometry} />\n          <mesh castShadow material={colorMaterial} geometry={nodes['Mesh enemy_ufoPurple_2'].geometry} />\n          <mesh material={materials.glass} geometry={nodes['Mesh enemy_ufoPurple_3'].geometry} /> */}\n          <UfoModel\n            ref={ufoRef}\n            colorPalette={PALETTES[props.model || 1]}\n            // position={[0, 0, 0]}\n          />\n          <mesh\n            visible={!isFreezed}\n            material={indicatorMaterial}\n            rotation={[-THREE.Math.degToRad(90), -THREE.Math.degToRad(0), -THREE.Math.degToRad(90)]}\n            position={indicatorOffset}\n            geometry={indicatorGeometry}\n          />\n        </group>\n      </>\n    </Suspense>\n  )\n})\n\nexport default Model\n","import { useState } from 'react'\nimport { useFrame } from '@react-three/fiber'\nimport { isOutOfArena } from '../helpers/arenaHelper'\n\nfunction useOutOfTheBox (elementRef) {\n  const [isOut, setIsOut] = useState(false)\n  useFrame(function() {\n    // check off platform\n    const { freeze } = elementRef.current?.userData || {}\n    if (elementRef.current && elementRef.current?.position && !freeze) {\n      if (isOutOfArena(elementRef)) {\n        setIsOut(true)\n      } else {\n        setIsOut(false)\n      }\n    }\n  })\n  return isOut\n}\n\nexport default useOutOfTheBox","export const isOutOfArena = ref => {\n  const outFromLeft = ref.current.position.x > 7.5\n  const outFromRight = ref.current.position.x < -7.5\n  const outFromTop = ref.current.position.z < -7.5\n  const outFromBottom = ref.current.position.z > 7.5\n  return outFromLeft || outFromRight || outFromTop || outFromBottom\n}\n","import anime from './anime'\n\nfunction animateFallUp(elementRef, onComplete) {\n  // animate destroy in threejs\n  const transformation = {\n    positionY: elementRef.current.position.y\n  };\n  anime(\n    {\n      easing: 'easeInBack',\n      duration: 1024,\n      positionY: 10,\n      targets: transformation,\n      update: function () {\n        if(!elementRef.current) return\n        elementRef.current.position.y = transformation.positionY;\n      },\n      complete: onComplete,\n    }\n  )\n}\n\nexport default animateFallUp\n","import React, { useEffect, forwardRef, useMemo } from 'react'\nimport { useApi } from '../../systems/Physics/hooks'\nimport { useEvents } from '../../systems/World/hooks'\nimport UfoBase from '../UfoShip'\nimport useOutOfTheBox from '../../hooks/useOutOfTheBox'\nimport animateFallUp from '../../helpers/animateFallUp'\nimport { CHARACTER_EVENTS, GAME_EVENTS } from '../../systems/World/Events'\n\nconst Player = forwardRef((props, externalRef) => {\n  const api = useApi()\n  const { userController, ...moreProps } = props\n  const outOfRing = useOutOfTheBox(externalRef)\n  const triggerOutOfRing = useEvents(CHARACTER_EVENTS.OUT_OF_RING)\n  const triggerImpulseOn = useEvents(CHARACTER_EVENTS.IMPULSE_ON)\n  const triggerImpulseOff = useEvents(CHARACTER_EVENTS.IMPULSE_OFF)\n  useEvents(GAME_EVENTS.READY_ON, () => {api.unfreeze(externalRef.current.uuid)})\n  useEffect(() => {\n    if (outOfRing) {\n      api.outOfThisWorld(externalRef.current.uuid)\n      triggerOutOfRing(externalRef)\n      animateFallUp(externalRef, () => { /*respawnMe(externalRef, api)*/ })\n    }\n  }, [outOfRing])\n  useEffect(() => {\n    const unsubscribeControllerOn = userController.addEventListener('controller_on', () => {\n      api.impulse(externalRef.current.uuid, true)\n      triggerImpulseOn({ uuid: externalRef.current.uuid, api })\n\n    })\n    const unsubscribeControllerOff = userController.addEventListener('controller_off', () => {\n      api.impulse(externalRef.current.uuid, false)\n      triggerImpulseOff({ uuid: externalRef.current.uuid, api })\n    })\n    const unsubscribeControllerRestart = userController.addEventListener('controller_restart', () => {\n      api.restart(externalRef.current.uuid)\n    })\n    const unsubscribeControllerDoubleTap = userController.addEventListener('controller_doubleTap', () => {\n      api.revertSpin(externalRef.current.uuid)\n    })\n    return () => {\n      unsubscribeControllerOn()\n      unsubscribeControllerOff()\n      unsubscribeControllerRestart()\n      unsubscribeControllerDoubleTap()\n    }\n  }, [externalRef.current])\n  \n  return useMemo(() =>\n    <UfoBase\n      ref={externalRef}\n      {...moreProps}\n      userData={{\n        origin: moreProps.position,\n        density: 1,\n        isPlayer: true,\n        freeze: true,\n        spinFactor: 1,\n        spinSpeed: 2,\n        model: 1,\n      }}\n    />, []\n  )\n})\n\nexport default Player\n","function respawnMe(elementRef, api) {\n  // delay for weird UI behaviour\n  setTimeout(() => {\n    api.restart(elementRef.current.uuid, elementRef.current.userData.origin)\n    elementRef.current.userData = { ...elementRef.current.userData, freeze: false }\n    elementRef.current.position.y = 0;\n  }, 100);\n}\nexport default respawnMe\n","import { useRef, useLayoutEffect, useEffect } from 'react'\nimport { CollisionsManager } from '../systems/World/EventsManager'\n\nfunction useCollision(callback: Function, uuid: string): null {\n  const subscribe = CollisionsManager.onCollide.bind(CollisionsManager)\n  // Update ref\n  const ref = useRef(callback)\n  useLayoutEffect(() => void (ref.current = callback), [callback])\n  // Subscribe/unsub\n  useEffect(() => {\n    const unsubscribe = subscribe(callback, uuid)\n    return () => unsubscribe()\n  }, [uuid, subscribe])\n  return null\n}\n\nexport default useCollision","import React, { useState, useEffect, useRef, forwardRef, useMemo } from 'react'\nimport { useFrame } from '@react-three/fiber'\nimport { THREE } from 'expo-three'\nimport { useApi } from '../../systems/Physics/hooks'\nimport { useEvents } from '../../systems/World/hooks'\nimport UfoShip from '../UfoShip'\nimport useOutOfTheBox from '../../hooks/useOutOfTheBox'\nimport animateFallUp from '../../helpers/animateFallUp'\nimport respawnMe from '../../helpers/respawnMe'\nimport { CHARACTER_EVENTS, GAME_EVENTS } from '../../systems/World/Events'\nimport useCollision from '../../hooks/useCollision'\n\nconst useTurnsCounter = (callback, ref) => {\n  const flagSafeTurn = useRef(true);\n  const [turns, setTurns] = useState(0)\n  const [originalAngle, setOriginalAngle] = useState(0)\n  const [active, setActive] = useState()\n  useFrame(() => {\n    if (!ref.current || !active) return\n    if (~~ref.current.rotation.y === originalAngle) {\n      if (flagSafeTurn.current) {\n        setTurns(turns + 1)\n        flagSafeTurn.current = false\n      }\n    } else {\n      flagSafeTurn.current = true\n    }\n  })\n  useEffect(() => {\n    if (!ref.current || !active) return\n    setOriginalAngle(~~ref.current.rotation.y)\n  }, [ref.current])\n\n  useEffect(() => {\n    if(turns !== 0) {\n      callback(turns)\n    }\n  }, [turns])\n\n  useEvents(GAME_EVENTS.READY_ON, () => setActive(true))\n  useEvents(GAME_EVENTS.READY_OFF, () => setActive(false))\n  \n  // useTimeout(() => setTurns(1), 1000)\n  \n  return null\n}\n\nconst getAggressivenessByModel = model => model === 4 ? 0.8 : model === 3 ? 0.5 : model === 2 ? 0.3 : 0\nconst getWandernessByModel = model => model === 4 ? 0.9 : model === 3 ? 0.8 : model === 2 ? 0.7 : 0\nconst getReflexesByModel = model => model === 4 ? 1000 : model === 3 ? 2000 : model === 2 ? 3000 : 4000\nconst Enemy = forwardRef(({\n  userController,\n  enemies,\n  model,\n  spin,\n  ...props\n}, externalRef) => {\n  \n  const api = useApi()\n  // const [attack, setAttack] = useState(false);\n  const target = useRef()\n  const impulse = useRef(200)\n  const impulseRef = useRef()\n  const impulseTID = useRef()\n  const retargetTID = useRef()\n  const outOfRing = useOutOfTheBox(externalRef)\n  const triggerOutOfRing = useEvents(CHARACTER_EVENTS.OUT_OF_RING)\n  const triggerImpulseOn = useEvents(CHARACTER_EVENTS.IMPULSE_ON)\n  const triggerImpulseOff = useEvents(CHARACTER_EVENTS.IMPULSE_OFF)\n  useEvents(GAME_EVENTS.READY_ON, () => {\n    api.unfreeze(externalRef.current.uuid)\n    setTarget('attack')\n  })\n  useCollision(() => {\n    setTarget()\n  }, externalRef.current?.uuid)\n  useEffect(() => {\n    if (outOfRing) {\n      // setAttack(false)\n      api.outOfThisWorld(externalRef.current.uuid)\n      triggerOutOfRing(externalRef)\n      animateFallUp(externalRef, () => {\n        /* respawnMe(externalRef, api) */\n        api.destroy(externalRef.current.uuid)\n      })\n    }\n  }, [outOfRing])\n  // const externalRef = useRef(null)\n  const lookObject = new THREE.Object3D();\n\n  function applyImpuse() {\n    impulseRef.current = true\n    api.impulse(externalRef.current.uuid, true)\n    triggerImpulseOn({ uuid: externalRef.current.uuid, api })\n  }\n  function stopImpulse() {\n    impulseRef.current = false\n    api.impulse(externalRef.current.uuid, false)\n    triggerImpulseOff({ uuid: externalRef.current.uuid, api })\n  }\n  function setTarget(forceTo) {\n    const aggressiveness = getAggressivenessByModel(model)\n    // const vagueness = model === 4 ? 0.1 : model === 3 ? 0.3 : model === 2 ? 0.5 : 0.8\n    const wanderness = getWandernessByModel(model)\n    \n    if (Math.random() < aggressiveness || forceTo === 'attack') {\n      // attack\n      target.current = enemies[0].current\n    } else if (Math.random() < wanderness || forceTo === 'wander') {\n      // wander\n      const range = (min, max) => Math.random() * (max - min) + min\n      target.current = new THREE.Object3D()\n      const pos = new THREE.Vector3( Math.round(range(5, -5)), 0, Math.round(range(5, -5)))\n      target.current.position.copy(pos)\n    } else {\n      // wait\n    }\n\n    // refresh target after 3 secs\n    clearTimeout(retargetTID.current)\n    retargetTID.current = setTimeout(() => {\n      setTarget()\n    }, getReflexesByModel(model));\n  }\n\n  useFrame(() => {\n    if (target.current) {\n      const myself = externalRef.current\n      const targetObj = target.current\n      const impulseDuration = impulse.current\n      // update helper position\n      lookObject.position.copy(myself.position)\n      // make helper to look at enemy (usually a player)\n      lookObject.lookAt(targetObj.position)\n      // dunno why I need to subtract 90 deg to Y rotation after lookAt\n      lookObject.rotateY(-Math.PI / 2)\n\n      if (lookObject.quaternion.angleTo(myself.quaternion) < 0.1 && !impulseRef.current) {\n        applyImpuse()\n        clearTimeout(impulseTID.current)\n        impulseTID.current = setTimeout(stopImpulse, impulseDuration)\n      }\n    }\n    \n  })\n  \n  // how many times did a 360 spin\n  useTurnsCounter(turns => {\n    // counr?\n  }, externalRef)\n\n  let spinSpeed = 2\n  switch (model) {\n    case 1:\n    default:\n      spinSpeed = 2\n      break\n    case 2:\n      spinSpeed = 1.5\n      break\n    case 3:\n      spinSpeed = 2\n      break\n    case 4:\n      spinSpeed = 2.5\n      break\n  }\n  return useMemo(() =>\n    <UfoShip\n      ref={externalRef}\n      model={model}\n      {...props}\n      userData={{\n        origin: props.position,\n        rotate: true,\n        detached: false,\n        isEnemy: true,\n        freeze: true,\n        spinFactor: spin === 'ccw' ? -1 : 1,\n        spinSpeed,\n        model,\n      }} />, [])\n})\n\nexport default Enemy\n","import Box2D from 'box2dweb'\nconst b2Vec2 = Box2D.Common.Math.b2Vec2\nconst b2RayCastOutput = Box2D.Collision.b2RayCastOutput\nlet playerBody\nlet enemyBody\nlet hittable = false\nexport default function loop(refs) {\n  Object.keys(refs).forEach(r => {\n    const { object, body } = refs[r]\n    // handle position for development purpose\n    if (body && object) {\n      // if (object.userData.isPlayer && !playerBody) {\n      //   playerBody = body\n      //   const playerPos = playerBody.GetPosition()\n      //   playerPos.x = 0\n      //   playerPos.y = -4\n      //   playerBody.SetTransform({ position: playerPos, GetAngle: () => playerBody.GetAngle() })\n      // }\n      // if (object.userData.isEnemy && !enemyBody) {\n      //   enemyBody = body\n      //   const enemyPos = enemyBody.GetPosition()\n      //   enemyPos.x = -2\n      //   enemyPos.y = 0\n      //   enemyBody.SetTransform({ position: enemyPos, GetAngle: () => enemyBody.GetAngle() })\n      // }\n\n      const { impulse, rotate, spinSpeed = 2, originPosition, pickable, spinFactor } = body.GetUserData()\n      \n      let angle = body.GetAngle()\n      \n      const pos = body.GetPosition()\n      if (impulse) {\n        const power = 0.1// + body.GetLinearDamping() //+ body.GetFixtureList().GetDensity() * 0.1\n        const direction = new b2Vec2(power * Math.cos(angle * Math.PI / 180), power * Math.sin(angle * Math.PI / 180))\n\n        body.ApplyImpulse(direction, body.GetWorldCenter())\n      }\n      if (rotate) {\n        angle = angle + (spinSpeed * spinFactor)\n        if (angle > 360) {\n          angle -= 360\n        } else if (angle < -360) {\n          angle += 360\n        }\n        body.SetTransform({ position: body.GetPosition(), GetAngle: () => angle })\n      }\n      // Apply Box2d props to Three object\n      const newPos = { x: pos.x, y: object.position.y, z: pos.y };\n      object.position.copy(newPos)\n\n      object.rotation.y = (-angle * Math.PI / 180)\n    }\n  })\n}","import Box2D from 'box2dweb'\nimport { EventsManager } from './EventsManager'\nimport { CHARACTER_EVENTS } from './Events'\n\nconst b2Vec2 = Box2D.Common.Math.b2Vec2\nconst b2RayCastOutput = Box2D.Collision.b2RayCastOutput\n\nconst fixtureIsCharacter = fix => fix.GetBody().GetUserData().isPlayer || fix.GetBody().GetUserData().isEnemy\nconst isDirectHit = (fixA, fixB) => {\n  let rayCastOutput = new b2RayCastOutput\n  const bodyA = fixA.GetBody()\n  const rayLength = 1\n  const p1 = bodyA.GetPosition()\n  const bodyAPosX = Math.cos(bodyA.GetAngle() / 180 * Math.PI)\n  const bodyAPosY = Math.sin(bodyA.GetAngle() / 180 * Math.PI)\n  const dest = new b2Vec2(\n    rayLength * bodyAPosX,\n    rayLength * bodyAPosY\n  )\n  const p2 = new b2Vec2(p1.x, p1.y)\n  p2.Add(dest)\n  \n  const rayInput = {\n    p1,\n    p2,\n    maxFraction: 1,\n  }\n\n  return fixB.RayCast(rayCastOutput, rayInput)\n}\nconst isOvercharged = fix => fix.GetBody().GetUserData().coil || fix.GetBody().GetUserData().freezer\n\nconst applyExtraImpulse = (fixA, fixB) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  // direction based on angle\n  const bodyAPosX = Math.cos(bodyA.GetAngle() / 180 * Math.PI)\n  const bodyAPosY = Math.sin(bodyA.GetAngle() / 180 * Math.PI)\n\n  // if both are normal, multiply hit by 5.\n  let extraPower = 5\n  // if hit-giver is Hulk, multiply hit power by 10.\n  extraPower = bodyA.GetUserData().hulk ? 10 : extraPower\n  // if hit-receiver is Hulk, keep hit power.\n  extraPower = bodyB.GetUserData().hulk ? 0 : extraPower\n  // if hit-giver is dead (freezed), keep hit power\n  extraPower = !bodyA.GetUserData().impulse ? 0 : extraPower\n  // x times of \n  const impulseVector = new b2Vec2(\n    extraPower * bodyAPosX,\n    extraPower * bodyAPosY\n  )\n  \n  bodyB.ApplyImpulse(impulseVector, bodyB.GetWorldCenter())\n}\n\nconst applyOverchargeCoil = (fixA, fixB) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  const posA = bodyA.GetPosition()\n  const posB = bodyB.GetPosition().Copy()\n\n  // distance between two objs position\n  posB.Subtract(posA)\n  // normalize to 0,0\n  posB.Normalize()\n  // x times of force of the kickback\n  const extraPower = 15\n\n  const impulseVector = new b2Vec2(\n    extraPower * posB.x,\n    extraPower * posB.y\n  )\n\n  bodyB.ApplyImpulse(impulseVector, bodyB.GetWorldCenter())\n}\n\nconst overchargeReaction = (fixA, fixB) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  if (bodyA.GetUserData().coil) {\n    bodyA.SetUserData({ ...bodyA.GetUserData(), coil: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_COIL, bodyB.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyA.GetUserData().uuid)\n    applyOverchargeCoil(fixA, fixB)\n  }\n  if (bodyB.GetUserData().coil) {\n    bodyB.SetUserData({ ...bodyB.GetUserData(), coil: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_COIL, bodyA.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyB.GetUserData().uuid)\n    applyOverchargeCoil(fixB, fixA)\n  }\n\n  if (bodyB.GetUserData().freezer) {\n    bodyB.SetUserData({ ...bodyB.GetUserData(), freezer: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyB.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_FREEZER, bodyA.GetUserData().uuid)\n    setTimeout(() => {\n      EventsManager.dispatch(CHARACTER_EVENTS.UNFREEZE, bodyA.GetUserData().uuid)\n    }, 5000);\n    bodyA.SetUserData({ ...bodyA.GetUserData(), rotate: false, freeze: true, impulse: false })\n  }\n  if (bodyA.GetUserData().freezer) {\n    bodyA.SetUserData({ ...bodyA.GetUserData(), freezer: false})\n    EventsManager.dispatch(CHARACTER_EVENTS.DISCHARGE, bodyA.GetUserData().uuid)\n    EventsManager.dispatch(CHARACTER_EVENTS.GETS_FREEZER, bodyB.GetUserData().uuid)\n    setTimeout(() => {\n      EventsManager.dispatch(CHARACTER_EVENTS.UNFREEZE, bodyB.GetUserData().uuid)\n    }, 5000);\n    bodyB.SetUserData({ ...bodyB.GetUserData(), rotate: false, freeze: true, impulse: false })\n  }\n}\n\nconst setHitBy = (fixA, fixB, directHitAtoB, directHitBtoA) => {\n  const bodyA = fixA.GetBody()\n  const bodyB = fixB.GetBody()\n  const bodyAData = bodyA.GetUserData()\n  const bodyBData = bodyB.GetUserData()\n  const time = new Date()\n  bodyA.SetUserData({ ...bodyAData, hitBy: bodyBData.uuid, hitByTime: time, hitByDirect: directHitBtoA })\n  bodyB.SetUserData({ ...bodyBData, hitBy: bodyAData.uuid, hitByTime: time, hitByDirect: directHitAtoB })\n}\n\nexport default function HitPhysics (b2Contact) {\n  const fixA = b2Contact.GetFixtureA()\n  const fixB = b2Contact.GetFixtureB()\n  const isTwoCharactersHit = fixtureIsCharacter(fixA) && fixtureIsCharacter(fixB)\n  if (isTwoCharactersHit) {\n    const isDirectHitAtoB = isDirectHit(fixA, fixB)\n    const isDirectHitBtoA = isDirectHit(fixB, fixA)\n    setHitBy(fixA, fixB, isDirectHitAtoB, isDirectHitBtoA)\n    if (isOvercharged(fixA) || isOvercharged(fixB)) {\n      overchargeReaction(fixA, fixB)\n    } else {\n      // only if no ship is overcharged\n      if (isDirectHitAtoB) {\n        applyExtraImpulse(fixA, fixB)\n      }\n      if (isDirectHitBtoA) {\n        applyExtraImpulse(fixB, fixA)\n      }\n    }\n  }\n}","import React, { useState, useEffect, useRef, useMemo } from 'react'\nimport Box2D from 'box2dweb'\nimport { THREE } from 'expo-three';\nimport context from './context'\nimport { useFrame } from '@react-three/fiber'\nimport { CollisionsManager } from '../World/EventsManager'\nimport CharactersLoop from '../World/CharactersLoop'\nimport HitPhysics from '../World/HitPhysics'\n\nconst b2World = Box2D.Dynamics.b2World\nconst b2Vec2 = Box2D.Common.Math.b2Vec2\nconst b2BodyDef = Box2D.Dynamics.b2BodyDef;\nconst b2Body = Box2D.Dynamics.b2Body;\nconst b2FixtureDef = Box2D.Dynamics.b2FixtureDef;\nconst b2ContactListener = Box2D.Dynamics.b2ContactListener;\n\nfunction emptyCallback () { return false }\nexport default function Provider({\n  children,\n  onReady\n}) {\n  const [world, setWorld] = useState()\n  const [clock] = useState(new THREE.Clock())\n  const refs = {}\n  const bodies = []\n  let destroyQueue = []\n  const actions = {\n    impulse: () => {\n  \n    }\n  }\n  useFrame(() => {\n    if (world && !world.IsLocked()) {\n      // if (!world.IsLocked()) {\n        // }\n      CharactersLoop(refs)\n      const timestep =  clock.getDelta()// 1 / 60\n      world.Step(1/60, 10, 8)\n      while(destroyQueue.length) {\n        world.DestroyBody(destroyQueue.pop())\n      }\n    }\n  })\n  useEffect(() => {\n    const gravity = new b2Vec2(0, 0)\n    var world = new b2World(gravity, true)\n    \n    const contactListener = new b2ContactListener;\n    contactListener.BeginContact = CollisionsManager.dispatchOnBeginContact.bind(CollisionsManager)\n    contactListener.EndContact = CollisionsManager.dispatchOnEndContact.bind(CollisionsManager)\n    world.SetContactListener(contactListener)\n    world.SetContinuousPhysics(true)\n\n    CollisionsManager.onEndContact(HitPhysics)\n\n    setWorld(world)\n    return () => {\n      // destroy world ??\n    }\n  }, [])\n  // const api = useMemo(() => ({ bodies, world, refs, actions }), [bodies, world, refs, actions])\n  const api = { bodies, world, refs, actions, destroyQueue }\n  if (onReady) {\n    onReady(api)\n  }\n  return <context.Provider value={api}>{children}</context.Provider>\n}","import React, { Suspense, createContext, lazy } from 'react'\nimport Provider from './Provider'\n\n// const Provider = typeof window === 'undefined' ? () => null : lazy(() => import('./Provider'))\n\nfunction Physics(props) {\n  return (\n    // <Suspense fallback={null}>\n      <Provider {...props} />\n    // </Suspense>\n  )\n}\n\nexport { Physics }\n","const crystalMinTimeToAppear = 16000\nconst levels = [\n  {\n    id: 1,\n    arena: {\n      name: 'Granite',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#999999',\n      walls: [],\n    },\n    crystals: [{\n      type: 'grow',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }],\n  }, {\n    id: 2,\n    arena: {\n      name: 'Sand',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#9c6135',\n      walls: [],\n    },\n    crystals: [{\n      type: 'coil',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }],\n  }, {\n    id: 3,\n    arena: {\n      name: 'Malaquite',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#60944a',\n      walls: [],\n    },\n    crystals: [{\n      type: 'freezer',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 4,\n    arena: {\n      name: 'Turquoise',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#479186',\n      walls: [{\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [0, -0.22, -8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [-4, -0.22, -8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [4, -0.22, -8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [0, -0.22, 8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [-4, -0.22, 8],\n      }, {\n        color: '#479186',\n        rotate: Math.PI / 2,\n        position: [4, -0.22, 8],\n      }],\n    },\n    crystals: [{\n      type: 'grow',\n      position: [-4, 0.21, 4],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'coil',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'freezer',\n      position: [4, 0.21, -4],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4,\n    },],\n  }, {\n    id: 5,\n    arena: {\n      name: 'Aragonite',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#ff5e00',\n      walls: [{\n          color: '#ff5e00',\n          position: [-8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         position: [8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         rotate: Math.PI / 2,\n         position: [0, -0.22, -8],\n       }, {\n         color: '#ff5e00',\n         rotate: -Math.PI / 2,\n         position: [0, -0.22, 8],\n       }],\n    },\n    crystals: [{\n      type: 'freezer',\n      position: [-4, 0.21, -4],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'grow',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'coil',\n      position: [4, 0.21, 4],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, 0],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, 0],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 6,\n    arena: {\n      name: 'Jasper',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#ad1a2b',\n      walls: [{\n          color: '#ad1a2b',\n          position: [-8, -0.22, -5.5],\n       }, {\n          color: '#ad1a2b',\n          rotate: Math.PI / 2,\n          position: [-5.5, -0.22, -8],\n       }, {\n          color: '#ad1a2b',\n          position: [8, -0.22, 5.5],\n       }, {\n          color: '#ad1a2b',\n          position: [8, -0.22, -5.5],\n       }, {\n         color: '#ad1a2b',\n         rotate: Math.PI / 2,\n         position: [5.5, -0.22, -8],\n       }, {\n         color: '#ad1a2b',\n         rotate: Math.PI / 2,\n         position: [5.5, -0.22, 8],\n       }, {\n         color: '#ad1a2b',\n         rotate: -Math.PI / 2,\n         position: [-5.5, -0.22, 8],\n       }, {\n          color: '#ad1a2b',\n          position: [-8, -0.22, 5.5],\n       }],\n    },\n    crystals: [{\n      type: 'coil',\n      position: [5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'freezer',\n      position: [0, 0.21, 5],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [-5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 2,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 7,\n    arena: {\n      name: 'Amethyst',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#471182',\n      walls: [{\n          color: '#471182',\n          position: [-8, -0.22, 0],\n       }, {\n          color: '#471182',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [0, 0, 0],\n      hx: 14,\n      hy: 0.5,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'grow',\n      position: [-5, 0.21, -1],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'coil',\n      position: [-5, 0.21, 5],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'freezer',\n      position: [5, 0.21, 5],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 8,\n    arena: {\n      name: 'Topaz',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#1676a6',\n      walls: [{\n          // West-Middle\n          color: '#1676a6',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#1676a6',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#1676a6',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#1676a6',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#1676a6',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#1676a6',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#1676a6',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#1676a6',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [-2, 0, -2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [2, 0, 2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [2, 0, -2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [-2, 0, 2],\n      hx: 2,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'freezer',\n      position: [2, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'grow',\n      position: [-2, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'coil',\n      position: [0, 0.21, -2],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3\n    }, {\n      id: 'enemy2',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }],\n  }, {\n    id: 9,\n    arena: {\n      name: 'Sulfur',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#ebb800',\n      walls: [{\n          color: '#ff5e00',\n          position: [-8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         position: [8, -0.22, 0],\n       }, {\n         color: '#ff5e00',\n         rotate: Math.PI / 2,\n         position: [0, -0.22, -8],\n       }, {\n         color: '#ff5e00',\n         rotate: -Math.PI / 2,\n         position: [0, -0.22, 8],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [-5, 0, 0],\n      hx: 2,\n      hy: 8,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [5, 0, 0],\n      hx: 2,\n      hy: 8,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [0, 0, -5],\n      hx: 8,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }, {\n      position: [0, 0, 5],\n      hx: 8,\n      hy: 2,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'coil',\n      position: [0, 0.21, 7],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'freezer',\n      position: [-7, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [7, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 0],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [-5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, 5.1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n  }, {\n    id: 10,\n    arena: {\n      name: 'Graphite',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#33312f',\n      walls: [{\n          // West-Middle\n          color: '#33312f',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#33312f',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#33312f',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#33312f',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#33312f',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#33312f',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#33312f',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [0, 0, 0],\n      hx: 14,\n      hy: 0.5,\n      // rotate: Math.PI / 4,\n    }],\n    crystals: [{\n      type: 'coil',\n      position: [0, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'freezer',\n      position: [-5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [5, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, 1],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, -1],\n      color: '#9e18aa',\n      model: 4,\n    }],\n    portalGroups: [\n      [{ position: [-6, -0.3, -6]}, {position: [6, -0.3, 6]}],\n    ],\n  }, {\n    id: 11,\n    arena: {\n      name: 'The roof',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#33312f',\n      walls: [{\n          // West-Middle\n          color: '#33312f',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#33312f',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#33312f',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#33312f',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#33312f',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#33312f',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#33312f',\n          position: [8, -0.22, 0],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [-6, -0.3, -6],\n      hx: 2,\n      hy: 2,\n    }, {\n      position: [-6, -0.3, 6],\n      hx: 2,\n      hy: 2,\n    }],\n    crystals: [{\n      type: 'freezer',\n      position: [6, 0.21, 6],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'coil',\n      position: [-6, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'grow',\n      position: [6, 0.21, -6],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [-5.1, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [0, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 3,\n    }, {\n      id: 'enemy2',\n      position: [2.5, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 3,\n    }, {\n      id: 'enemy3',\n      position: [5.1, 0.22, -2.5],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, 0],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 4,\n    }],\n    portalGroups: [\n      [{ position: [-6, -0.3, -6]}, {position: [6, -0.3, 6]}],\n      [{ position: [-6, -0.3, 6]}, {position: [6, -0.3, -6]}],\n    ],\n  }, {\n    id: 12,\n    arena: {\n      name: 'The castle',\n      // texture: require('../../assets/textures/cube_rock_A_mat_baseColor.png'),\n      tint: '#33312f',\n      walls: [{\n          // West-Middle\n          color: '#33312f',\n          position: [-8, -0.22, 0],\n       }, {\n          // West-North\n          color: '#33312f',\n          position: [-8, -0.22, -6],\n       }, {\n          // North-West\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [-6, -0.22, -8],\n       }, {\n          // Morth-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, -8],\n       }, {\n          // East-North\n          color: '#33312f',\n          position: [8, -0.22, -6],\n       }, {\n          // East-South\n          color: '#33312f',\n          position: [8, -0.22, 6],\n       }, {\n          // South-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [6, -0.22, 8],\n       }, {\n          // North-East\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [5.5, -0.22, -8],\n       },{\n          // West-South\n          color: '#33312f',\n          position: [-8, -0.22, 6],\n       }, {\n          // South-West\n          color: '#33312f',\n          rotate: -Math.PI / 2,\n          position: [-5.5, -0.22, 8],\n       }, {\n          // South-Middle\n          color: '#33312f',\n          rotate: Math.PI / 2,\n          position: [0, -0.22, 8],\n       }, {\n          // Middle-Cross\n          color: '#33312f',\n          position: [8, -0.22, 0],\n       }, {\n          // Xtra 1\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [-2.5, -0.22, 7.5],\n       }, {\n          // Xtra 2\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [3, -0.22, 7.5],\n       }, {\n          // Xtra 3\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [2.5, -0.22, -7.5],\n       }, {\n          // Xtra 4\n          color: '#262523',\n          rotate: Math.PI / 2,\n          position: [-3, -0.22, -7.5],\n       }, {\n          // Xtra 5\n          color: '#262523',\n          position: [-7.5, -0.22, -3],\n       }, {\n          // Xtra 6\n          color: '#262523',\n          position: [7.5, -0.22, -3],\n       }, {\n          // Xtra 7\n          color: '#262523',\n          position: [7.5, -0.22, 3],\n       }, {\n          // Xtra 8\n          color: '#262523',\n          position: [-7.5, -0.22, 3],\n       }],\n    },\n    spinReverseAreas: [{\n      position: [0, 0, 0],\n      hx: 4,\n      hy: 4,\n    }],\n    crystals: [{\n      type: 'coil',\n      position: [6, 0.21, 6],\n      timeToAppear: crystalMinTimeToAppear, // ms\n    }, {\n      type: 'grow',\n      position: [-6, 0.21, 0],\n      timeToAppear: crystalMinTimeToAppear * 2.5, // ms\n    }, {\n      type: 'freezer',\n      position: [6, 0.21, -6],\n      timeToAppear: crystalMinTimeToAppear * 3.5, // ms\n    }],\n    player: {\n      position: [0, 0.22, 5.1],\n      color: '#0ac757',\n    },\n    enemies: [{\n      id: 'enemy1',\n      position: [-2.5, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy2',\n      position: [-5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 4,\n    }, {\n      id: 'enemy3',\n      position: [2.5, 0.22, -5.1],\n      color: '#9e18aa',\n      model: 4,\n    }, {\n      id: 'enemy4',\n      position: [5.1, 0.22, -5.1],\n      color: '#9e18aa',\n      spin: 'ccw',\n      model: 4,\n    }],\n    portalGroups: [\n      [{ position: [-5.1, 0, 0]}, {position: [5.1, 0, 0]}],\n    ],\n  }\n]\n\n\nexport default levels\n","/*\nauto-generated by: https://github.com/react-spring/gltfjsx\n*/\n\nimport { THREE } from 'expo-three'\nimport React, { useRef, useEffect, useState } from 'react'\nimport { useFrame } from '@react-three/fiber'\nimport { useApi, useCircle } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/crystals/detail_crystal.obj'\nimport modelMtl from '../../../assets/crystals/detail_crystal.mtl'\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\n\nconst COLORS_BY_TYPE = {\n  grow: 0x006600,\n  coil: 0x2a4db5,\n  freezer: 0x99ccff,\n}\n\nfunction hide(ref) {\n  if (ref.current.visible) {\n    ref.current.visible = false\n  }\n}\nfunction show(ref) {\n  if (!ref.current.visible) {\n    ref.current.visible = true\n  }\n}\n\nconst Model = props => {\n  const { type, timeToAppear, ...passProps } = props\n  const [step, setStep] = useState('HIDDEN')\n  const ref = useRef()\n  const circleRef = useRef()\n  const [geometry, setGeometry] = useState()\n  const [baseRef] = useCircle({}, ref)\n  const api = useApi()\n  const triggerOnPickCoil = useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_COIL)\n  const triggerOnPickFreezer = useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_FREEZER)\n  const triggerOnPickGrow = useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_GROW)\n  const triggerOnOvercharge = useEvents(CHARACTER_EVENTS.OVERCHARGE)\n  \n  useCollision(collidedFixture => {\n    if (step === 'AVAILABLE') {\n      setStep('PICKED')\n      const uuid = collidedFixture.GetBody().GetUserData().uuid\n      if (type === 'grow') {\n        api.grow(uuid)\n        triggerOnPickGrow(uuid)\n      }\n      if (type === 'coil') {\n        api.overchargePower(uuid)\n        triggerOnPickCoil(uuid)\n        triggerOnOvercharge(uuid)\n      }\n      if (type === 'freezer') {\n        api.overchargeFreezer(uuid)\n        triggerOnPickFreezer(uuid)\n        triggerOnOvercharge(uuid)\n      }\n    }\n  }, baseRef.current?.uuid)\n  \n  // change pink by green\n  let colorMaterial = new THREE.MeshLambertMaterial({ color: COLORS_BY_TYPE[type] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material = colorMaterial\n\n    obj.children[0].castShadow = true\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  useEffect(() => {\n    setTimeout(() => {\n      setStep('APPROACHING')\n    }, timeToAppear);\n  },[])\n  \n  function animationLoop() {\n    switch (step) {\n      case 'HIDDEN':\n        hide(circleRef)\n        hide(baseRef)\n        break\n      case 'APPROACHING':\n        show(circleRef)\n        if (circleRef.current.scale.x > 0) {\n          circleRef.current.scale.x = circleRef.current.scale.y = circleRef.current.scale.z -= 0.005\n        } else {\n          setStep('AVAILABLE')\n        }\n        break\n      case 'AVAILABLE':\n        hide(circleRef)\n        show(baseRef)\n        break\n      case 'PICKED':\n        hide(baseRef)\n        break\n      default:\n        break\n    }\n  }\n  useFrame(() => {\n    if (circleRef.current) {\n      animationLoop()\n    }\n  })\n  \n  return (\n    <>\n      <group\n        ref={circleRef}\n        position={passProps.position}\n      >\n        <mesh\n          rotation={[-Math.PI/2, 0, 0]}\n          geometry={new THREE.RingGeometry(14.99, 15, 62)}\n          material={new THREE.LineBasicMaterial({ color: 0xffff00 })}\n        />\n      </group>\n      <group\n        ref={baseRef}\n        visible={false}\n        // position={[0, 0.21, 0]}\n        {...passProps}\n        dispose={null}\n        userData={{\n          radius: 0.25,\n          pickable: true,\n          originPosition: [0, 0.25, 0],\n        }}\n      >\n        {geometry &&\n          <primitive object={geometry} />\n        }\n        {/* <mesh\n          castShadow\n          material={colorMaterial}\n          geometry={nodes.detail_crystal.geometry}\n        /> */}\n      </group>\n    </>\n  )\n}\n\nexport default Model","import React, { Suspense, useEffect, useRef } from 'react'\nimport { Canvas } from '@react-three/fiber'\nimport { Audio } from 'expo-av'\nimport { OrbitControls, Stars, axesHelper, Html } from '@react-three/drei'\nimport { WorldEvents } from '../../systems/World'\nimport { useEvents } from '../../systems/World/hooks'\nimport CountDown from '../../components/CountDown'\nimport { Controllers, getPlayers } from '../../systems/HUD'\n// import Rock from '../../components/Cube'\nimport Rock from '../../components/Arena'\nimport Player from '../../components/Player'\nimport Enemy from '../../components/Enemy'\nimport { Physics } from '../../systems/Physics'\nimport LEVELS from '../../constants/levels'\nimport { CHARACTER_EVENTS, GAME_EVENTS } from '../../systems/World/Events'\nimport Crystal from '../../components/Crystal'\nimport Wall from '../../components/Wall'\nimport RevertSpinArea from '../../components/RevertSpinArea'\nimport Portals from '../../components/Portals'\nimport {\n  SIMPLE_HIT,\n  GAME_OVER,\n  GAME_WON,\n  ENEMY_DOWN,\n  SCENE_LOADED,\n  OVERCHARGED,\n  FROZEN,\n  COILED,\n  TELEPORTED,\n  IMPULSE_ON,\n  IMPULSE_OFF,\n  GROWN,\n} from '../../constants/webView_comm_messages'\n\nconst [player1, player2] = getPlayers(2)\nlet playersOnArena = [];\nlet playerRef;\nconst useLevels = levelId => {\n\n  const [sounds, setSounds] = React.useState();\n\n  async function loadSounds() {\n    const sounds = {}\n    const createSoundAsync = async asset => {\n      const { sound } = await Audio.Sound.createAsync(asset)\n      return sound\n    }\n    \n    sounds.arena_completed = await createSoundAsync(require('../../../assets/sounds/music/arena_completed.mp3'))\n    sounds.arena_won = await createSoundAsync(require('../../../assets/sounds/music/arena_won.mp3'))\n\n    setSounds(sounds);\n  }\n  useEffect(() => {\n    // should unload but i'm reloading page so \n  }, [sounds])\n\n  useEffect(() => {\n    loadSounds()\n    return () => {\n      playersOnArena = []\n    }\n  },[])\n  const playSound = soundId => sounds[soundId].replayAsync()\n\n  const CURRENT_LEVEL = LEVELS[levelId]\n  const enemyRefs = CURRENT_LEVEL.enemies.map(() => useRef(null))\n  const wallRefs = CURRENT_LEVEL.arena.walls.map(() => useRef())\n  playerRef = useRef(null)\n  playersOnArena = [playerRef, ...enemyRefs]\n  const pos = useRef(CURRENT_LEVEL.enemies.length + 1)\n  useEvents(CHARACTER_EVENTS.OUT_OF_RING, characterRef => {\n    const isUserFall = characterRef === playerRef\n    const playersAlive = playersOnArena.filter(pRef => pRef !== characterRef)\n    const thereArePlayersLeft = playersAlive.length > 0\n    const onlyOnePlayersLeft = playersAlive.length === 1\n    const userIsAlive = playersAlive.find(pRef => pRef === playerRef) !== undefined\n\n    if (!isUserFall && userIsAlive) {\n      pos.current = pos.current - 1\n      window.ReactNativeWebView?.postMessage(`${ENEMY_DOWN}:${pos.current}`);\n    }\n    if (thereArePlayersLeft && isUserFall) {\n      playSound('arena_completed')\n      setTimeout(() => {\n        window.ReactNativeWebView?.postMessage(`${GAME_OVER}:${pos.current}`);\n      }\n      , 1000)\n    }\n    if (userIsAlive && onlyOnePlayersLeft) {\n      playSound('arena_won')\n      setTimeout(() => {\n        window.ReactNativeWebView?.postMessage(GAME_WON);\n      }\n      , 1000)\n    }\n    playersOnArena = playersAlive;\n  })\n  // playersOnArena.push(...[playerRef, ...enemyRefs])\n  return [\n    <Player\n      position={CURRENT_LEVEL.player.position}\n      radius={0.5}\n      userController={player2}\n      color={CURRENT_LEVEL.player.color}\n      ref={playerRef}\n    />,\n    CURRENT_LEVEL.enemies.map((enemy, idx) => \n      <Enemy\n        key={enemy.id}\n        position={enemy.position}\n        radius={0.5}\n        color={enemy.color}\n        ref={enemyRefs[idx]}\n        enemies={[playerRef]}\n        model={enemy.model}\n        spin={enemy.spin}\n      />\n    ),\n    CURRENT_LEVEL.arena.walls.map((wall, idx) =>\n      <Wall\n        key={`wall_${idx}`}\n        position={wall.position}\n        color={wall.color}\n        rotate={wall.rotate}\n        hx={0.25}\n        hy={3}\n        ref={wallRefs[idx]}\n      />\n    ),\n    CURRENT_LEVEL.crystals.map((crystal, idx) =>\n      <Crystal\n        key={`crystal_${idx}`}\n        position={crystal.position}\n        scale={[1.5, 1.5, 1.5]}\n        type={crystal.type}\n        timeToAppear={crystal.timeToAppear}\n      />\n    ),\n    CURRENT_LEVEL.portalGroups?.map((portals, idx) =>\n      <Portals\n        key={`portals_${idx}`}\n        positionBlue={portals[1].position}\n        positionRed={portals[0].position}\n      />\n    ),\n    CURRENT_LEVEL.spinReverseAreas?.map((area, idx) =>\n      <RevertSpinArea\n        key={`spin_area_${idx}`}\n        position={area.position}\n        hx={area.hx}\n        hy={area.hy}\n        rotate={area.rotate}\n      />\n    )\n  ]\n}\n\nconst GamePlay = ({ onLoad, currentLevel = 0, onEnd }) => {\n  const [player, enemies, walls, crystals, portals, spinReverseAreas] = useLevels(currentLevel)\n  const arena = LEVELS[currentLevel].arena\n\n  const [sounds, setSounds] = React.useState();\n\n  async function loadSounds() {\n    const sounds = {}\n    const createSoundAsync = async asset => {\n      const { sound } = await Audio.Sound.createAsync(asset)\n      return sound\n    }\n    \n    sounds.simpleHit = await createSoundAsync(require('../../../assets/sounds/fx/ufoHit.mp3'))\n    sounds.teleport = await createSoundAsync(require('../../../assets/sounds/fx/teleport.mp3'))\n    sounds.coil_discharge = await createSoundAsync(require('../../../assets/sounds/fx/coil_discharge.mp3'))\n    sounds.crystal_pick = await createSoundAsync(require('../../../assets/sounds/fx/crystal_pick.mp3'))\n    sounds.grow = await createSoundAsync(require('../../../assets/sounds/fx/grow.mp3'))\n    sounds.freezeEffect = await createSoundAsync(require('../../../assets/sounds/fx/freezeEffect.mp3'))\n    sounds.gameplay = await createSoundAsync(require('../../../assets/sounds/music/gameplay.mp3'))\n\n    setSounds(sounds);\n  }\n  useEffect(() => {\n    // should unload but i'm reloading page so \n  }, [sounds]);\n\n  useEffect(() => {\n    loadSounds()\n  }, [])\n\n  const playSound = (soundId, props) => sounds[soundId].replayAsync(props)\n\n  useEvents(CHARACTER_EVENTS.BEGIN_CONTACT, contact => {\n    const fixtureA = contact.GetFixtureA()\n    const fixtureB = contact.GetFixtureB()\n    const dataA = fixtureA.GetBody().GetUserData()\n    const dataB = fixtureB.GetBody().GetUserData()\n    if ((dataA.isPlayer || dataA.isEnemy || dataA.isWall) && (dataB.isPlayer || dataB.isEnemy || dataB.isWall)) {\n      // window.ReactNativeWebView?.postMessage(SIMPLE_HIT);\n      playSound('simpleHit')\n    }\n  })\n  useEvents(GAME_EVENTS.SYSTEM_ONLINE, () => {\n    playSound('gameplay')\n  })\n  useEvents(CHARACTER_EVENTS.GETS_FREEZER, () => {\n    playSound('freezeEffect')\n  })\n  useEvents(CHARACTER_EVENTS.GETS_COIL, () => {\n    playSound('coil_discharge')\n  })\n  useEvents(CHARACTER_EVENTS.OVERCHARGE, () => {\n    playSound('crystal_pick')\n  })\n  useEvents(CHARACTER_EVENTS.PICK_CRYSTAL_GROW, () => {\n    playSound('grow')\n  })\n  useEvents(CHARACTER_EVENTS.TELEPORT, () => {\n    playSound('teleport')\n  })\n\n  return (\n    <>\n      <WorldEvents>\n        <Canvas\n          style={{ background: \"#171717\"\n            , flexBasis: '100%', width: 900, minHeight: 400, margin: 'auto'\n          }}\n          shadows\n          // invalidateFrameloop\n          // pixelRatio={Dimensions.get('window').height / Dimensions.get('window').width}\n\n          // camera={{ position: [-5, 11, 20], fov: 30 }}\n          camera={{ position: [-3, -15, 10], fov: 30 }}\n          concurrent\n          gl={{ antialias: true }}\n          onCreated={({ gl, camera }) => {\n            camera.lookAt(0, 0, 3)\n          }}\n        >\n          <CountDown />\n          <ambientLight intensity={1} color=\"#dadada\"/>\n        \n          <pointLight position={[-5, 50, 0]} intensity={0.2} distance={10} color=\"lightblue\" />\n          \n          <directionalLight\n            castShadow\n            position={[5, 8, -5]}\n            intensity={0.5}\n            // color=\"#ff9760\"\n            color=\"#ffffff\"\n            shadow-mapSize-width={600}\n            shadow-mapSize-height={600}\n            shadow-camera-far={50}\n            shadow-camera-left={-10}\n            shadow-camera-right={10}\n            shadow-camera-top={10}\n            shadow-camera-bottom={-10}\n          />\n          <Physics>\n            {crystals}\n            {enemies}\n            {player}\n            {walls}\n            {portals}\n            {spinReverseAreas}\n          </Physics>\n          <Rock\n            tint={arena.tint}\n            name={arena.name}\n            scale={[16, 16, 16]}\n            position={[0, -8.3, 0]}\n            receiveShadow\n          />\n          <Stars/>\n        </Canvas>\n      </WorldEvents>\n      <Controllers forPlayers={[player1, player2]} noUI={false}/>\n    </>\n  )\n}\n\nexport default GamePlay\n","import React, { forwardRef, useRef, useMemo, useState } from 'react'\nimport { THREE } from 'expo-three';\nimport { useBox } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport anime from '../../helpers/anime';\n\nexport default forwardRef(({\n  hx = 0.5,\n  hy = 3,\n  rotate = 0,\n  color = '#34383a',\n  ...props\n}, ref) => {\n  let api\n  let baseRef = ref || useRef();\n  [baseRef, api] = useBox({}, ref)\n  const [material] = useState(new THREE.MeshLambertMaterial({ color, transparent: true, opacity: 1, wireframe: false }))\n\n  useCollision(() => {\n    api.destroy(baseRef.current?.uuid)\n    anime({\n      easing: 'linear',\n      duration: 500,\n      opacity: 0,\n      targets: material,\n      complete: () => {\n        baseRef.current.visible = false\n      },\n    })\n  }\n  , baseRef.current?.uuid)\n\n  return useMemo(() => {\n    return (\n      <>\n        <mesh\n          ref={baseRef}\n          rotation={[-Math.PI / 2, 0, rotate]}\n          {...props}\n          userData={{\n            origin: props.position,\n            static: true,\n            hx: hx/2,\n            hy: hy/2,\n            rotate: false,\n            angle: rotate,\n            isWall: true,\n          }}\n          material={material}\n          castShadow\n        >\n          <boxBufferGeometry args={[hx, hy, hy/2, 10]} />\n          {/* <meshStandardMaterial color={'orange'} /> */}\n        </mesh>\n      </>\n    )\n  }\n  , [])\n})","import React, { forwardRef, useRef, useEffect, useState } from 'react'\nimport { THREE } from 'expo-three';\nimport { useBox } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport { useEvents } from '../../systems/World/hooks';\nimport { CHARACTER_EVENTS } from '../../systems/World/Events';\n\nexport default forwardRef(({\n  hx = 4,\n  hy = 4,\n  rotate = 0,\n  color = 'red',\n  ...props\n}, ref) => {\n  let api\n  let baseRef = ref || useRef();\n  [baseRef, api] = useBox({}, ref)\n  const [material] = useState(new THREE.MeshNormalMaterial({ color, transparent: true, opacity: 0.25, wireframe: false }))\n  const spinRevertTrigger = useEvents(CHARACTER_EVENTS.EXTERNAL_SPIN_CHANGE)\n\n  useCollision(collidedFixture => {\n    const uuid = collidedFixture.GetBody().GetUserData().uuid\n    api.revertSpin(uuid)\n    spinRevertTrigger(uuid)\n  }\n  , baseRef.current?.uuid)\n\n  return (\n    <mesh\n      ref={baseRef}\n      rotation={[0, 0, 0]}\n      {...props}\n      userData={{ origin: props.position, pickable: true, hx: hx/2, hy: hy/2, rotate: false, angle: rotate }}\n      material={material}\n      // castShadow\n    >\n      <boxBufferGeometry args={[hx, 0.2, hy, 10]} />\n      {/* <meshStandardMaterial color={'orange'} /> */}\n    </mesh>\n  )\n})","import React, { useRef, forwardRef, useState, useEffect } from 'react'\nimport { useLoader, useFrame } from '@react-three/fiber'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { THREE } from 'expo-three'\n\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\n\nimport modelObj from '../../../assets/round_base/towerRound_base.obj'\nimport modelMtl from '../../../assets/round_base/towerRound_base.mtl'\n\n\nconst loaderObj = new OBJLoader();\nconst loaderMtl = new MTLLoader();\nconst loaderTxt = new THREE.TextureLoader();\n\n// const mapImage = loaderTxt.load(require('../../../assets/textures/cone.png'));\n// const assetURL = 'https://raw.githubusercontent.com/Cosmitar/threejs_assets/master/ufo_ships/enemy_ufoPurple.glb'\n\nconst getGradientMap = color => {\n  const alphaIndex = 1\n  const colors = new Uint8Array( alphaIndex + 2 )\n\n  for ( let c = 0; c <= colors.length; c ++ ) {\n\n    colors[ c ] = ( c / colors.length ) * 256;\n\n  }\n\n  const gradientMap = new THREE.DataTexture( colors, colors.length, 1, THREE.LuminanceFormat );\n  gradientMap.minFilter = THREE.NearestFilter;\n  gradientMap.magFilter = THREE.NearestFilter;\n  gradientMap.generateMipmaps = false;\n  return gradientMap\n}\n\nconst textureLoader = new THREE.TextureLoader()\n\nexport default forwardRef((props, ref) => {\n  const fwdRef = ref || useRef()\n  const [geometry, setGeometry] = useState()\n  const [materialOffsetDirection, setMaterialOffsetDirection] = useState(1)\n  const { colorPalette = [], ...moreProps } = props\n\n  const threeTone = textureLoader.load(require('../../../assets/threeTone.jpg'));\n  threeTone.minFilter = THREE.NearestFilter;\n  threeTone.magFilter = THREE.NearestFilter;\n  \n  const matTest = new THREE.MeshBasicMaterial({ color: 'lime' })\n  const materialChassis = colorPalette[0] ? new THREE.MeshToonMaterial({ color: colorPalette[0], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDeco = colorPalette[1] ? new THREE.MeshToonMaterial({ color: colorPalette[1], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialCore = colorPalette[2] ? new THREE.MeshToonMaterial({ color: colorPalette[2], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n  const materialDome = colorPalette[3] ? new THREE.MeshToonMaterial({ color: colorPalette[3], gradientMap: threeTone }) : new THREE.MeshLambertMaterial({ color: colorPalette[0] })\n\n  const loadObject = async () => {\n    const mtl = loaderMtl.parse(modelMtl)\n    mtl.preload();\n    loaderObj.setMaterials(mtl)\n    const obj = loaderObj.parse(modelObj)\n    obj.children[0].material[0] = materialDeco// red\n    obj.children[0].material[1] = materialChassis// stone\n    obj.children[0].material[2] = materialDome// stoneDark\n    setGeometry(obj)\n  }\n\n  useEffect(loadObject,[])\n\n  // useFrame(() => {\n  //   if (mapImage.offset) {\n  //     mapImage.wrapS = THREE.RepeatWrapping;\n  //     mapImage.wrapT = THREE.RepeatWrapping;\n  //     if(mapImage.offset.y > 0.9) { \n  //       mapImage.offset.y = -0.5\n  //       // mapImage.offset.x = mapImage.offset.y = -0.5\n  //       // setMaterialOffsetDirection(-1)\n  //     }\n  //     // if(mapImage.offset.x < -0.5 && materialOffsetDirection < 0) { \n  //     //   setMaterialOffsetDirection(1)\n  //     // }\n  //     mapImage.offset.x += (0.002 * materialOffsetDirection)\n  //     // mapImage.offset.y += (0.002 * materialOffsetDirection)\n  //   }\n  //   // if (fwdRef.current && fwdRef.current.children[1]) {\n  //   //   // fwdRef.current.children[1].rotation.y += 0.02\n  //   // }\n  // })\n  var materials = [\n    new THREE.MeshLambertMaterial( { /*map: mapImage,*/ transparent: true, color: colorPalette[0], side: THREE.DoubleSide } ),\n    new THREE.MeshLambertMaterial( { transparent: true, opacity: 0 } ),\n    new THREE.MeshLambertMaterial( { transparent: true, opacity: 0 } )\n];\n  return (\n    <group\n      ref={fwdRef}\n      {...moreProps}\n    >\n      {geometry &&\n        <primitive object={geometry} />\n      }\n      <mesh\n        rotation={[Math.PI, 0, 0]}\n        position={[0, 0.5, 0]}\n        material={materials}\n      >\n        <coneBufferGeometry args={[0.5, 1.5, 32]}/>\n        {/* <meshLambertMaterial opacity={1} color={colorPalette[0]} transparent map={mapImage} alphaTest={0.1} /> */}\n        {/* <meshLambertMaterial color={colorPalette[0]} opacity={0.3} transparent /> */}\n      </mesh>\n    </group>\n  )\n})","import React, { useRef } from 'react'\nimport { useApi, useCircle } from '../../systems/Physics/hooks'\nimport useCollision from '../../hooks/useCollision'\nimport UfoBase from '../UfoBase'\nimport { useEvents } from '../../systems/World/hooks'\nimport { CHARACTER_EVENTS } from '../../systems/World/Events'\n\nconst Portals = ({ positionBlue = [0,0,0], positionRed = [5, 0, 5]}) => {\n  const [portalBlue] = useCircle({})\n  const [portalRed] = useCircle({})\n  let teleporting = useRef([]).current\n  const api = useApi()\n  const onTeleportTrigger = useEvents(CHARACTER_EVENTS.TELEPORT)\n  useCollision(collidedFixture => {\n    const uuid = collidedFixture.GetBody().GetUserData().uuid\n    if (!teleporting.includes(uuid)) {\n      teleporting.push(uuid)\n      setTimeout(() => {\n        api.hyperJump(\n          uuid,\n          { x: positionRed[0], y: positionRed[2] }\n        )\n        onTeleportTrigger()\n      }, 0)\n    } else {\n      teleporting = teleporting.filter(id => id !== uuid)\n    }\n  }, portalBlue.current?.uuid)\n  useCollision(collidedFixture => {\n    const uuid = collidedFixture.GetBody().GetUserData().uuid\n    if (!teleporting.includes(uuid)) {\n      teleporting.push(uuid)\n      setTimeout(() => {\n        api.hyperJump(\n          collidedFixture.GetBody().GetUserData().uuid,\n          { x: positionBlue[0], y: positionBlue[2] }\n        )\n        onTeleportTrigger()\n      }, 0);\n    } else {\n      teleporting = teleporting.filter(id => id !== uuid)\n    }\n  }, portalRed.current?.uuid)\n\n  return (\n    <>\n      <UfoBase\n        ref={portalBlue}\n        colorPalette={[\n          '#32aaf8',\n          '#ff2147',\n          '#878787',\n          '#e4e4ef'\n        ]}\n        position={positionBlue}\n        userData={{ origin: positionBlue, pickable: true, radius: 0.25, rotate: false }}\n      />\n        \n      <UfoBase\n        ref={portalRed}\n        colorPalette={[\n          '#ff2147',\n          '#32aaf8',\n          '#878787',\n          '#e4e4ef'\n        ]}\n        position={positionRed}\n        userData={{ origin: positionRed, pickable: true, radius: 0.25, rotate: false }}\n      />\n    </>\n  )\n}\n\nexport default Portals","import EventsService from '../../helpers/eventsService'\nimport Controllers from './Controllers'\n\nconst getPlayers = amount => {\n  return Array(amount).fill(0).map(() => \n    new EventsService\n  )\n}\n\nexport {\n  Controllers,\n  getPlayers,\n}\n","export const ON_LINE_NOTIFICATION = 'SS@system_online'\nexport const SCENE_LOADED = 'SS@scene_loaded'\nexport const TITLES_LOADED = 'SS@titles_scene_loaded'\nexport const SIMPLE_HIT = 'SS@hit'\nexport const GAME_OVER = 'SS@game_over'\nexport const GAME_WON = 'SS@game_won'\nexport const ENEMY_DOWN = 'SS@enemy_down'\nexport const FROZEN = 'SS@ufo_frozen'\nexport const COILED = 'SS@ufo_coiled'\nexport const OVERCHARGED = 'SS@ufo_overcharged'\nexport const GROWN = 'SS@ufo_magnified'\nexport const TELEPORTED = 'SS@ufo_teleported'\nexport const IMPULSE_ON = 'SS@ufo_impule_on'\nexport const IMPULSE_OFF = 'SS@ufo_impulse_off'\nexport const THE_END_BEGINS = 'SS@the_end_begins'\nexport const THE_END_ENDS = 'SS@the_end_ends'","'use strict';\n\nclass Color {\n  constructor(r, g, b) {\n    this.set(r, g, b);\n  }\n  \n  toString() {\n    return `rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`;\n  }\n\n  set(r, g, b) {\n    this.r = this.clamp(r);\n    this.g = this.clamp(g);\n    this.b = this.clamp(b);\n  }\n\n  hueRotate(angle = 0) {\n    angle = angle / 180 * Math.PI;\n    const sin = Math.sin(angle);\n    const cos = Math.cos(angle);\n\n    this.multiply([\n      0.213 + cos * 0.787 - sin * 0.213,\n      0.715 - cos * 0.715 - sin * 0.715,\n      0.072 - cos * 0.072 + sin * 0.928,\n      0.213 - cos * 0.213 + sin * 0.143,\n      0.715 + cos * 0.285 + sin * 0.140,\n      0.072 - cos * 0.072 - sin * 0.283,\n      0.213 - cos * 0.213 - sin * 0.787,\n      0.715 - cos * 0.715 + sin * 0.715,\n      0.072 + cos * 0.928 + sin * 0.072,\n    ]);\n  }\n\n  grayscale(value = 1) {\n    this.multiply([\n      0.2126 + 0.7874 * (1 - value),\n      0.7152 - 0.7152 * (1 - value),\n      0.0722 - 0.0722 * (1 - value),\n      0.2126 - 0.2126 * (1 - value),\n      0.7152 + 0.2848 * (1 - value),\n      0.0722 - 0.0722 * (1 - value),\n      0.2126 - 0.2126 * (1 - value),\n      0.7152 - 0.7152 * (1 - value),\n      0.0722 + 0.9278 * (1 - value),\n    ]);\n  }\n\n  sepia(value = 1) {\n    this.multiply([\n      0.393 + 0.607 * (1 - value),\n      0.769 - 0.769 * (1 - value),\n      0.189 - 0.189 * (1 - value),\n      0.349 - 0.349 * (1 - value),\n      0.686 + 0.314 * (1 - value),\n      0.168 - 0.168 * (1 - value),\n      0.272 - 0.272 * (1 - value),\n      0.534 - 0.534 * (1 - value),\n      0.131 + 0.869 * (1 - value),\n    ]);\n  }\n\n  saturate(value = 1) {\n    this.multiply([\n      0.213 + 0.787 * value,\n      0.715 - 0.715 * value,\n      0.072 - 0.072 * value,\n      0.213 - 0.213 * value,\n      0.715 + 0.285 * value,\n      0.072 - 0.072 * value,\n      0.213 - 0.213 * value,\n      0.715 - 0.715 * value,\n      0.072 + 0.928 * value,\n    ]);\n  }\n\n  multiply(matrix) {\n    const newR = this.clamp(this.r * matrix[0] + this.g * matrix[1] + this.b * matrix[2]);\n    const newG = this.clamp(this.r * matrix[3] + this.g * matrix[4] + this.b * matrix[5]);\n    const newB = this.clamp(this.r * matrix[6] + this.g * matrix[7] + this.b * matrix[8]);\n    this.r = newR;\n    this.g = newG;\n    this.b = newB;\n  }\n\n  brightness(value = 1) {\n    this.linear(value);\n  }\n  contrast(value = 1) {\n    this.linear(value, -(0.5 * value) + 0.5);\n  }\n\n  linear(slope = 1, intercept = 0) {\n    this.r = this.clamp(this.r * slope + intercept * 255);\n    this.g = this.clamp(this.g * slope + intercept * 255);\n    this.b = this.clamp(this.b * slope + intercept * 255);\n  }\n\n  invert(value = 1) {\n    this.r = this.clamp((value + this.r / 255 * (1 - 2 * value)) * 255);\n    this.g = this.clamp((value + this.g / 255 * (1 - 2 * value)) * 255);\n    this.b = this.clamp((value + this.b / 255 * (1 - 2 * value)) * 255);\n  }\n\n  hsl() {\n    // Code taken from https://stackoverflow.com/a/9493060/2688027, licensed under CC BY-SA.\n    const r = this.r / 255;\n    const g = this.g / 255;\n    const b = this.b / 255;\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h, s, l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0;\n    } else {\n      const d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      switch (max) {\n        case r:\n          h = (g - b) / d + (g < b ? 6 : 0);\n          break;\n\n        case g:\n          h = (b - r) / d + 2;\n          break;\n\n        case b:\n          h = (r - g) / d + 4;\n          break;\n      }\n      h /= 6;\n    }\n\n    return {\n      h: h * 100,\n      s: s * 100,\n      l: l * 100,\n    };\n  }\n\n  clamp(value) {\n    if (value > 255) {\n      value = 255;\n    } else if (value < 0) {\n      value = 0;\n    }\n    return value;\n  }\n}\n\nclass Solver {\n  constructor(target, baseColor) {\n    this.target = target;\n    this.targetHSL = target.hsl();\n    this.reusedColor = new Color(0, 0, 0);\n  }\n\n  solve() {\n    const result = this.solveNarrow(this.solveWide());\n    return {\n      values: result.values,\n      loss: result.loss,\n      filter: this.css(result.values),\n    };\n  }\n\n  solveWide() {\n    const A = 5;\n    const c = 15;\n    const a = [60, 180, 18000, 600, 1.2, 1.2];\n\n    let best = { loss: Infinity };\n    for (let i = 0; best.loss > 25 && i < 3; i++) {\n      const initial = [50, 20, 3750, 50, 100, 100];\n      const result = this.spsa(A, a, c, initial, 1000);\n      if (result.loss < best.loss) {\n        best = result;\n      }\n    }\n    return best;\n  }\n\n  solveNarrow(wide) {\n    const A = wide.loss;\n    const c = 2;\n    const A1 = A + 1;\n    const a = [0.25 * A1, 0.25 * A1, A1, 0.25 * A1, 0.2 * A1, 0.2 * A1];\n    return this.spsa(A, a, c, wide.values, 500);\n  }\n\n  spsa(A, a, c, values, iters) {\n    const alpha = 1;\n    const gamma = 0.16666666666666666;\n\n    let best = null;\n    let bestLoss = Infinity;\n    const deltas = new Array(6);\n    const highArgs = new Array(6);\n    const lowArgs = new Array(6);\n\n    for (let k = 0; k < iters; k++) {\n      const ck = c / Math.pow(k + 1, gamma);\n      for (let i = 0; i < 6; i++) {\n        deltas[i] = Math.random() > 0.5 ? 1 : -1;\n        highArgs[i] = values[i] + ck * deltas[i];\n        lowArgs[i] = values[i] - ck * deltas[i];\n      }\n\n      const lossDiff = this.loss(highArgs) - this.loss(lowArgs);\n      for (let i = 0; i < 6; i++) {\n        const g = lossDiff / (2 * ck) * deltas[i];\n        const ak = a[i] / Math.pow(A + k + 1, alpha);\n        values[i] = fix(values[i] - ak * g, i);\n      }\n\n      const loss = this.loss(values);\n      if (loss < bestLoss) {\n        best = values.slice(0);\n        bestLoss = loss;\n      }\n    }\n    return { values: best, loss: bestLoss };\n\n    function fix(value, idx) {\n      let max = 100;\n      if (idx === 2 /* saturate */) {\n        max = 7500;\n      } else if (idx === 4 /* brightness */ || idx === 5 /* contrast */) {\n        max = 200;\n      }\n\n      if (idx === 3 /* hue-rotate */) {\n        if (value > max) {\n          value %= max;\n        } else if (value < 0) {\n          value = max + value % max;\n        }\n      } else if (value < 0) {\n        value = 0;\n      } else if (value > max) {\n        value = max;\n      }\n      return value;\n    }\n  }\n\n  loss(filters) {\n    // Argument is array of percentages.\n    const color = this.reusedColor;\n    color.set(0, 0, 0);\n\n    color.invert(filters[0] / 100);\n    color.sepia(filters[1] / 100);\n    color.saturate(filters[2] / 100);\n    color.hueRotate(filters[3] * 3.6);\n    color.brightness(filters[4] / 100);\n    color.contrast(filters[5] / 100);\n\n    const colorHSL = color.hsl();\n    return (\n      Math.abs(color.r - this.target.r) +\n      Math.abs(color.g - this.target.g) +\n      Math.abs(color.b - this.target.b) +\n      Math.abs(colorHSL.h - this.targetHSL.h) +\n      Math.abs(colorHSL.s - this.targetHSL.s) +\n      Math.abs(colorHSL.l - this.targetHSL.l)\n    );\n  }\n\n  css(filters) {\n    function fmt(idx, multiplier = 1) {\n      return Math.round(filters[idx] * multiplier);\n    }\n    return `invert(${fmt(0)}%) sepia(${fmt(1)}%) saturate(${fmt(2)}%) hue-rotate(${fmt(3, 3.6)}deg) brightness(${fmt(4)}%) contrast(${fmt(5)}%)`;\n  }\n}\n\nfunction hexToRgb(hex) {\n  // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n  const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  hex = hex.replace(shorthandRegex, (m, r, g, b) => {\n    return r + r + g + g + b + b;\n  });\n\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? [\n      parseInt(result[1], 16),\n      parseInt(result[2], 16),\n      parseInt(result[3], 16),\n    ]\n    : null;\n}\n\nconst computeFilters = (hexcolor) => {\n  const rgb = hexToRgb(hexcolor);\n  if (rgb.length !== 3) {\n    alert('Invalid format!');\n    return;\n  }\n\n  const color = new Color(rgb[0], rgb[1], rgb[2]);\n  const solver = new Solver(color);\n  const result = solver.solve();\n\n  let lossMsg;\n  if (result.loss < 1) {\n    lossMsg = 'This is a perfect result.';\n  } else if (result.loss < 5) {\n    lossMsg = 'The is close enough.';\n  } else if (result.loss < 15) {\n    lossMsg = 'The color is somewhat off. Consider running it again.';\n  } else {\n    lossMsg = 'The color is extremely off. Run it again!';\n  }\n\n  // $('.realPixel').css('background-color', color.toString());\n  // $('.filterPixel').attr('style', result.filter);\n  // $('.filterDetail').text(result.filter);\n  // $('.lossDetail').html(`Loss: ${result.loss.toFixed(1)}. <b>${lossMsg}</b>`);\n  return result.filter\n};\n\nexport default computeFilters;\n","import React, { useEffect } from 'react'\nimport { View, Text } from 'react-native'\nimport arenaIcon from '../../../assets/arena/icon.png'\nimport arenaIconMask from '../../../assets/arena/icon_mask.png'\nimport lockIcon from '../../../assets/icons/locked.png'\nimport trophyIcon from '../../../assets/icons/trophy.png'\nimport arrowIcon from '../../../assets/icons/arrowDown.png'\nimport computeFilters from '../../helpers/computeFilters'\nimport levels from '../../constants/levels'\nimport { useStateHooks } from '../../state/provider'\nexport default ({ onSelect }) => {\n  const { state: {\n    screen,\n    overlay,\n    currentLevel,\n    latestArenaResult,\n    arenas,\n  }, ...actions } = useStateHooks().app\n  return (\n    <>\n      <View style={{ flexWrap: 'wrap', flexDirection: 'row', justifyContent: 'center', maxWidth: 400, height: '100%', margin: 'auto' }}>\n        {levels.map((l, idx) => {\n          const locked = arenas[idx].locked\n          const arenaWon = arenas[idx].result === 1\n          const arenaDone = [2, 3].includes(arenas[idx].result)\n          const currentArena = !locked && arenas[idx + 1] && arenas[idx + 1].locked\n          return (\n            <View key={l.id} style={{ width: 100, height: 100, position: 'realtive' }}\n              onTouchEnd={() => !locked ? onSelect(idx) : null}\n              onClick={() => !locked ? onSelect(idx) : null}\n            >\n              <img width={100} height={100} src={arenaIconMask} style={{\n                filter: computeFilters(l.arena.tint),\n                position: 'absolute',\n                opacity: 0.5\n              }}/>\n              <img width={100} height={100} src={arenaIcon} style={{ visibility: locked ? 'hidden' : 'visible '}}/>\n              {locked && <img src={lockIcon} style={{\n                position: 'absolute', width: 50, height: 50, top: '40%', left: '25%',\n                opacity: 0.8\n              }} />}\n              {arenaWon && <img src={trophyIcon} style={{ position: 'absolute', width: 50, height: 50, top: '10%', left: '25%',\n                filter: computeFilters('#ffcd0a'),\n              }} />}\n              {currentArena && <img src={arrowIcon} style={{ position: 'absolute', width: 50, height: 50, top: '10%', left: '25%',\n                filter: computeFilters('#dbdbdb'),\n              }} />}\n              \n              <View style={{ alignItems: 'center' }}>\n                <Text>{l.arena.name}</Text>\n              </View>\n            </View>\n          )\n      })}\n      </View>\n    </>\n  )\n}\n\n\n","import React, { useEffect, useRef, useState } from 'react'\nimport GamePlay from '../GamePlay'\nimport LevelSelection from '../LevelSelection'\nimport {GAME_OVER, GAME_WON} from '../../constants/webView_comm_messages'\nimport { useStateHooks } from '../../state/provider'\nimport { View } from 'react-native'\nimport ConfettiCannon from 'react-native-confetti-cannon'\n\nexport default function ScreenManager() {\n  const tId = useRef();\n  const [screen, setScreen] = useState('LEVEL_SELECTION')\n  const [selectedLevel, setSelectedLevel] = useState();\n  const levelSelectionHandler = idx => {\n    setSelectedLevel(idx)\n    setScreen('GAME_PLAY');\n  }\n  const { state: {\n    overlay,\n    currentLevel,\n    latestArenaResult,\n    showEnding,\n    arenas = [],\n  }, ...actions } = useStateHooks().app\n  \n  useEffect(() => {\n    window.ReactNativeWebView = {\n      postMessage: (msgKey) => {\n        const [eventName, value] = msgKey.split(':')\n        switch(eventName) {\n          case GAME_OVER:\n            actions.setArenaResult(selectedLevel, Number(value))\n            setTimeout(() => window.location.reload(), 2000)\n            break\n          case GAME_WON:\n            const totalCompleted = arenas.reduce((t, a) => {\n              return a.result === 1 ? t + 1 : t\n            }, 0)\n            const isGameCompleted = totalCompleted === arenas.length - 1 && arenas[selectedLevel].result !== 1;\n            actions.setArenaResult(selectedLevel, 1)\n            if (isGameCompleted) {\n              actions.setShowEnding(true)\n            }\n            // setScreen('LEVEL_SELECTION');\n            // setTimeout(() => window.location.reload(), 2000)\n            break\n        }\n      }\n    };\n  }, [selectedLevel, arenas])\n  useEffect(() => {\n    if (showEnding && screen === 'LEVEL_SELECTION') {\n      tId.current = setTimeout(() => {\n        actions.setShowEnding(false)\n      }, 15000);\n    }\n    () => {\n      clearTimeout(tId.current)\n    }\n  }, [showEnding])\n  return (\n    <View style={{ flexBasis: '100%', width: '100%', height: '100%', justifyContent: 'center', alignItems: 'center',\n      backgroundColor: screen === 'GAME_PLAY' ? '#171717' : '#171717'\n    }}>\n      <View style={{ maxWidth: 900, maxHeight: 400, width: '100%', height: '100%', backgroundColor: '#f0f0f0', margin: 'auto'}}>\n        {screen === 'HOME' && <Home onPlay={() => true} onRestart={() => true} />}\n        {screen === 'LEVEL_SELECTION' && <LevelSelection onSelect={levelSelectionHandler}/>}\n        {screen === 'GAME_PLAY' && <GamePlay currentLevel={selectedLevel} />}\n      </View>\n      {showEnding && screen === 'LEVEL_SELECTION' && <ConfettiCannon count={200} origin={{x: -10, y: 0}} />}\n    </View>\n  )\n}","import 'react-native-gesture-handler';\nimport { registerRootComponent } from 'expo';\n\nimport App from './App';\n\n// registerRootComponent calls AppRegistry.registerComponent('main', () => App);\n// It also ensures that whether you load the app in Expo Go or in a native build,\n// the environment is set up appropriately\nregisterRootComponent(App);\n","import React from 'react'\nimport { StateProvider } from './src/state/provider'\nimport ScreenManager from './src/screens/ScreenManager'\n\nexport default function App() {\n  return (\n    <StateProvider>\n      <ScreenManager />\n    </StateProvider>\n  )\n}\n// import { StatusBar } from 'expo-status-bar';\n// import React from 'react';\n// import { StyleSheet, Text, View } from 'react-native';\n\n// export default function App() {\n//   return (\n//     <View style={styles.container}>\n//       <Text>Open up App.js to start working on your app!</Text>\n//       <StatusBar style=\"auto\" />\n//     </View>\n//   );\n// }\n\n// const styles = StyleSheet.create({\n//   container: {\n//     flex: 1,\n//     backgroundColor: '#fff',\n//     alignItems: 'center',\n//     justifyContent: 'center',\n//   },\n// });\n","import Box2D from 'box2dweb'\nimport EventsService from '../../helpers/eventsService'\nimport { CHARACTER_EVENTS } from './Events';\n\ninterface b2ContactManager {\n  GetFixtureA:() => any,\n  GetFixtureB: () => any,\n}\n\nexport const EventsManager = new EventsService()\n\nclass Collisions {\n  service: any\n  constructor() {\n    this.service = EventsManager\n  }\n  \n  onAnyCollide(callback: Function) {\n    this.onBeginContact(callback)\n  }\n  onCollide(callback: Function, filterUUID: string): Function {\n    const filterCallback = (contact: b2ContactManager)  => {\n      const fixtureA = contact.GetFixtureA()\n      const fixtureB = contact.GetFixtureB()\n      const uuidA = fixtureA.GetBody().GetUserData().uuid\n      const uuidB = fixtureB.GetBody().GetUserData().uuid\n      const isRelevantCollistion = [uuidA, uuidB].includes(filterUUID)\n      const collideAgainstFixture = fixtureA.GetBody().GetUserData().uuid === filterUUID ? fixtureB : fixtureA\n      if (isRelevantCollistion) {\n        callback(collideAgainstFixture, contact)\n      }\n    }\n    return this.onBeginContact(filterCallback)\n  }\n\n  onBeginContact(callback: Function): Function {\n    return this.service.addEventListener(CHARACTER_EVENTS.BEGIN_CONTACT, callback)\n  }\n\n  onEndContact(callback: Function): Function {\n    return this.service.addEventListener(CHARACTER_EVENTS.END_CONTACT, callback)\n  }\n\n  dispatchOnBeginContact(contact: b2ContactManager) {\n    this.service.dispatch(CHARACTER_EVENTS.BEGIN_CONTACT, contact)\n  }\n\n  dispatchOnEndContact(contact: b2ContactManager) {\n    this.service.dispatch(CHARACTER_EVENTS.END_CONTACT, contact)\n  }\n}\n\n// class EventsManager {\n//   service: any\n//   constructor() {\n//     this.service = new EventsService()\n//   }\n// }\n\nexport const CollisionsManager = new Collisions()\n","module.exports = __webpack_public_path__ + \"static/media/threeTone.f981ce1c.jpg\";","import React, { Suspense, createContext, lazy } from 'react'\nimport { EventsManager } from './EventsManager'\n\nconst context = createContext(EventsManager)\nconst Provider = typeof window === 'undefined' ? () => null : lazy(() => import('./EventsProvider'))\n\nfunction WorldEvents(props) {\n  return (\n    <Suspense fallback={null}>\n      <Provider {...props} />\n    </Suspense>\n  )\n}\n\nexport { WorldEvents, context }\n","/** eventsService */\nclass EventsService {\n  constructor() {\n    this.callbacks = {}\n  }\n\n  /**\n   * @param {string} eventName\n   * @param {*} data\n   */\n  dispatch(eventName, data = null) {\n    if (this.callbacks[eventName]) {\n      this.callbacks[eventName].forEach(callback => {\n        callback(data);\n      });\n    }\n  }\n\n  /**\n   * @param {string} eventName name of event\n   * @param {Function} callback\n   */\n  addEventListener(eventName, callback) {\n    if (!this.callbacks.hasOwnProperty(eventName)) {\n      this.callbacks[eventName] = [];\n    }\n    this.callbacks[eventName].push(callback);\n    \n    // return unsubscribe\n    return () => this.removeEventListener(eventName, callback)\n  }\n\n  /**\n   * @param {string} eventName name of event\n   * @param {Function} callback\n   */\n  removeEventListener(eventName, callback) {\n    this.callbacks[eventName] = this.callbacks[eventName].filter(cb => cb !== callback)\n  }\n}\n\nexport default EventsService"],"sourceRoot":""}